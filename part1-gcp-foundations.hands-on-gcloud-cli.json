{"version":3,"kind":"Article","sha256":"ae5269fe6e21eca7cec1aa8dadc99c7a9ba8d335fa3361947a07fd71a4723a79","slug":"part1-gcp-foundations.hands-on-gcloud-cli","location":"/part1-gcp-foundations/05-hands-on-gcloud-cli.md","dependencies":[],"frontmatter":{"title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","content_includes_title":false,"authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/blob/main/part1-gcp-foundations/05-hands-on-gcloud-cli.md","edit_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/edit/main/part1-gcp-foundations/05-hands-on-gcloud-cli.md","thumbnail":"/gcp-tutorial-aims/build/hands-on2-gcloud-vm--5dab86ddf7d1bb7cb3b274cc2bd0b0cc.png","exports":[{"format":"md","filename":"05-hands-on-gcloud-cli.md","url":"/gcp-tutorial-aims/build/05-hands-on-gcloud-c-489d9a1ae95498e93be05149278a5803.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"paragraph","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"While the GCP Console is great for clicking through settings, using the ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"f86RUwNQNG"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"HarLcdLIOl"},{"type":"text","value":" ","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Tygu1UKpmX"},{"type":"strong","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"command-line interface (CLI)","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"yIO5UB1wCj"}],"key":"zkE3FHrbZJ"},{"type":"text","value":" is much more powerful. It allows your work to be repeatable and scriptable, meaning you can recreate your exact environment with a single command instead of dozens of manual clicks. It also enables automating tasks, such as starting or deleting multiple machines at once.","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"MX5v3lHysa"}],"key":"BKh2DcGOv3"},{"type":"heading","depth":2,"position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Installing the Google Cloud CLI","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"uLLIOdrXnS"}],"identifier":"installing-the-google-cloud-cli","label":"Installing the Google Cloud CLI","html_id":"installing-the-google-cloud-cli","implicit":true,"key":"sVcv9ZnCl7"},{"type":"paragraph","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"You need the Google Cloud CLI installed on your local machine to use ","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"C0G6iX06sR"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"GhVSdIWpjn"}],"key":"VYxRxUVbu8"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"Follow the official guides to download and install it:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"yQoXCzIDj6"}],"key":"Ey0i4sBIfx"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://docs.cloud.google.com/sdk/docs/install-sdk#windows","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"text","value":"Install for Windows","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"nzTlSK6zck"}],"urlSource":"https://docs.cloud.google.com/sdk/docs/install-sdk#windows","key":"b2ByRG3FFe"}],"key":"o9JBulwWsb"}],"key":"uvBfRV4trc"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://docs.cloud.google.com/sdk/docs/install-sdk#linux","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"text","value":"Install for Linux","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"eAgBPeNHWs"}],"urlSource":"https://docs.cloud.google.com/sdk/docs/install-sdk#linux","key":"AoDS70nSe5"}],"key":"tqyZdaGqFz"}],"key":"P8GwAA4kBw"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"link","url":"https://docs.cloud.google.com/sdk/docs/install-sdk#mac","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"children":[{"type":"text","value":"Install for macOS","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"O48tm09k3N"}],"urlSource":"https://docs.cloud.google.com/sdk/docs/install-sdk#mac","key":"TVKRkbt2rW"}],"key":"Twdz9PFYlV"}],"key":"lDdJXMnV2g"}],"key":"PExDdf4tQ3"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"w9EmfymbTh"}],"key":"tsTze46ss7"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"For AIMS Students, The Google Cloud CLI is already installed on all AIMS Campus desktops. If you run into any issues, kindly contact the IT team.","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ar2wMuvV2i"}],"key":"sqcBu046Qb"}],"key":"rSzFsGegVf"},{"type":"paragraph","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"After installation, run the ","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"JrktT22tse"},{"type":"inlineCode","value":"gcloud init","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"wlOPbOGqjb"},{"type":"text","value":" command in your terminal to log in and select your project.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"IQFJ0hfbpO"}],"key":"A0fsjEKcyN"},{"type":"code","lang":"bash","value":"gcloud init","key":"hAhj0Lc5yd"},{"type":"paragraph","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"strong","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"children":[{"type":"text","value":"Try these basic commands to make sure your terminal is connected to your GCP account:","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"xDx5cImQTG"}],"key":"KfYTba36AY"}],"key":"c9sKMj38rF"},{"type":"code","lang":"bash","value":"# See which project you are currently using\ngcloud config list project\n\n# List the VMs you currently have\ngcloud compute instances list","key":"n7koSIzM2W"},{"type":"heading","depth":3,"position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"children":[{"type":"text","value":"Creating a Virtual Machine (VM)","position":{"start":{"line":35,"column":1},"end":{"line":35,"column":1}},"key":"k9nq6ZsUtQ"}],"identifier":"creating-a-virtual-machine-vm","label":"Creating a Virtual Machine (VM)","html_id":"creating-a-virtual-machine-vm","implicit":true,"key":"roh1hVmhWP"},{"type":"heading","depth":3,"position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Step 1: Create a Secure Network (VPC)","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"cesthz0zMq"}],"identifier":"step-1-create-a-secure-network-vpc","label":"Step 1: Create a Secure Network (VPC)","html_id":"step-1-create-a-secure-network-vpc","implicit":true,"key":"H2vctCT1u5"},{"type":"paragraph","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"This creates a ","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"Jrd4Lbbubs"},{"type":"strong","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"children":[{"type":"text","value":"Virtual Private Cloud (VPC)","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"vsZg2xcqwe"}],"key":"wv09VF8JOe"},{"type":"text","value":" to isolate your computing resources within the project.","position":{"start":{"line":39,"column":1},"end":{"line":39,"column":1}},"key":"eNKWZbiVDB"}],"key":"YqruJlUZ4b"},{"type":"code","lang":"bash","value":"export AIMSUSERNAME=\"your_aims_username\" # This is for AIMS students\ngcloud compute networks create ${AIMSUSERNAME}-vpc --subnet-mode=auto","key":"wW3DHJlVsk"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"For Windows Users","position":{"start":{"line":46,"column":1},"end":{"line":46,"column":1}},"key":"wz2NFnUbkg"}],"key":"TVHD9dlWjD"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"The commands in this tutorial are written for ","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"zN5RrVBNxe"},{"type":"inlineCode","value":"bash","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"HfY1JM4IVB"},{"type":"text","value":". If you are using a Windows computer, we highly recommend installing Git Bash or Ubuntu via WSL (Windows Subsystem for Linux) so you can run these commands directly without modification.","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"JPYlQg9OlT"}],"key":"sghLBfC7Wv"},{"type":"paragraph","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"If you prefer to use your native Windows command shell, you must adapt how environment variables are set and retrieved for the commands/scripts in this tutorial. The Windows equivalent for the commands above would be:","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"LhOYySI9hd"}],"key":"cIbCs8ta0N"},{"type":"code","lang":"bash","value":"set AIMSUSERNAME=your_aims_username\ngcloud compute networks create %AIMSUSERNAME%-vpc --subnet-mode=auto","key":"yENSEx4xqr"}],"key":"wwv3aTu6wQ"},{"type":"heading","depth":3,"position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"children":[{"type":"text","value":"Step 2: Create a Firewall Rule for SSH","position":{"start":{"line":57,"column":1},"end":{"line":57,"column":1}},"key":"UiL4VkvY1F"}],"identifier":"step-2-create-a-firewall-rule-for-ssh","label":"Step 2: Create a Firewall Rule for SSH","html_id":"step-2-create-a-firewall-rule-for-ssh","implicit":true,"key":"ZKPPEi7NPs"},{"type":"paragraph","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"By default, all incoming traffic is blocked. This rule allows traffic on ","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"tEgBvFlUR2"},{"type":"strong","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"children":[{"type":"text","value":"Port 22","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"tfMEqPrrvW"}],"key":"M8KOn9kSM0"},{"type":"text","value":", which is required for SSH connections.","position":{"start":{"line":59,"column":1},"end":{"line":59,"column":1}},"key":"TvOgSfP98D"}],"key":"yJ6vgkOAQe"},{"type":"code","lang":"bash","value":"gcloud compute firewall-rules create ${AIMSUSERNAME}-fw-ssh \\\n    --network=${AIMSUSERNAME}-vpc \\\n    --allow=tcp:22","key":"sYTiwIzqDE"},{"type":"heading","depth":3,"position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"children":[{"type":"text","value":"Step 3: Set Up Internet Access (Router and NAT)","position":{"start":{"line":67,"column":1},"end":{"line":67,"column":1}},"key":"eDsA3rMsoI"}],"identifier":"step-3-set-up-internet-access-router-and-nat","label":"Step 3: Set Up Internet Access (Router and NAT)","html_id":"step-3-set-up-internet-access-router-and-nat","implicit":true,"key":"IYPZy0t7Wq"},{"type":"paragraph","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"children":[{"type":"text","value":"This allows your VM to access external resources (such as HuggingFace to download a model) without assigning a public External IP address to the instance.","position":{"start":{"line":69,"column":1},"end":{"line":69,"column":1}},"key":"nW8hvDGt1E"}],"key":"UJVGkSExfu"},{"type":"code","lang":"bash","value":"export REGION=\"europe-west4\" # This is your region\n\n# Create the Cloud Router\ngcloud compute routers create ${AIMSUSERNAME}-router-${REGION} \\\n    --network=${AIMSUSERNAME}-vpc \\\n    --region=${REGION}\n\n# Create the NAT configuration\ngcloud compute routers nats create ${AIMSUSERNAME}-nat-config \\\n    --router-region=${REGION} \\\n    --router=${AIMSUSERNAME}-router-${REGION} \\\n    --nat-all-subnet-ip-ranges \\\n    --auto-allocate-nat-external-ips","key":"ENV75yFoNz"},{"type":"heading","depth":3,"position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"children":[{"type":"text","value":"Step 4: Create the VM","position":{"start":{"line":87,"column":1},"end":{"line":87,"column":1}},"key":"Wwz83nyRfG"}],"identifier":"step-4-create-the-vm","label":"Step 4: Create the VM","html_id":"step-4-create-the-vm","implicit":true,"key":"BvRJEooveP"},{"type":"paragraph","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"children":[{"type":"text","value":"This command provisions a virtual machine with an NVIDIA L4 GPU. The L4 is a modern, cost-effective mid-range GPU with 24GB RAM.","position":{"start":{"line":89,"column":1},"end":{"line":89,"column":1}},"key":"HEcPgvzmIH"}],"key":"EvcAB1HM4Q"},{"type":"code","lang":"bash","value":"export ZONE=\"europe-west4-a\"\nexport VM_NAME=\"${AIMSUSERNAME}-l4-vm\" # Any other name works!\n\ngcloud compute instances create ${VM_NAME} \\\n    --zone=${ZONE} \\\n    --machine-type=g2-standard-4 \\\n    --accelerator=\"type=nvidia-l4,count=1\" \\\n    --image-family=common-cu128-ubuntu-2204-nvidia-570 \\\n    --image-project=deeplearning-platform-release \\\n    --maintenance-policy=TERMINATE \\\n    --network=${AIMSUSERNAME}-vpc","key":"Wi9j8uEhbC"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"yg5bFCyspF"}],"key":"LgqVsLKl7I"},{"type":"paragraph","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"If you need a more powerful GPU like an ","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"PVzmUa7oWh"},{"type":"strong","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"children":[{"type":"text","value":"A100","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"Vlemv4odTV"}],"key":"NixmK0flNO"},{"type":"text","value":", you only need to change two flags in the command above:","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"YmZoLIHycU"}],"key":"sUWznKTRY5"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":108,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"--machine-type","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"PcPg9vS8pE"},{"type":"text","value":": Change from ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"ryjfwbwoQt"},{"type":"inlineCode","value":"g2-standard-4","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"HCANXBds0J"},{"type":"text","value":" to an A2 machine type (e.g., ","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"APZ7zetIb8"},{"type":"inlineCode","value":"a2-highgpu-1g","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"b8iTA5ml8u"},{"type":"text","value":").","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"G8ulRptWoN"}],"key":"CXBMbSyN6O"}],"key":"pGOIcGidcW"},{"type":"listItem","spread":true,"position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"--accelerator","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"uqVrPDtu42"},{"type":"text","value":": Change from ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"onXP9Yxn7w"},{"type":"inlineCode","value":"type=nvidia-l4,count=1","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"vf9jIWBeP9"},{"type":"text","value":" to ","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"ySyZYItlRR"},{"type":"inlineCode","value":"type=nvidia-tesla-a100,count=1","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"jpV9HSx80y"},{"type":"text","value":".","position":{"start":{"line":109,"column":1},"end":{"line":109,"column":1}},"key":"gf87PeZQ7K"}],"key":"qyImRNwmSF"}],"key":"TbvzGnl6F6"}],"key":"YLyILDbvGA"}],"key":"JReG5dhqDV"},{"type":"paragraph","position":{"start":{"line":112,"column":1},"end":{"line":113,"column":1}},"children":[{"type":"strong","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"children":[{"type":"text","value":"Query the VM status","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"AKjutqDw9W"}],"key":"QrmE9k7wfy"},{"type":"text","value":":\nVerify that the instance has been provisioned and is in the ","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"osez8ZhnoO"},{"type":"inlineCode","value":"RUNNING","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"o9ULCPSim2"},{"type":"text","value":" state:","position":{"start":{"line":112,"column":1},"end":{"line":112,"column":1}},"key":"XfHhLgvea8"}],"key":"XtUzk9X2mX"},{"type":"code","lang":"bash","value":"gcloud compute instances list --filter=\"name=${VM_NAME}\"","key":"Gum1Nptay8"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/hands-on2-gcloud-vm--5dab86ddf7d1bb7cb3b274cc2bd0b0cc.png","alt":"gcloud VM creation output","align":"center","key":"O8pYSqfU57","urlSource":"./images/hands-on2-gcloud-vm-created.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"children":[{"type":"text","value":"Screenshot: L4 GPU VM created and queried successfully using ","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"zi6EvoOvB5"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":123,"column":1},"end":{"line":123,"column":1}},"key":"QFWLTVytM1"}],"key":"jykR8rtVq6"}],"key":"yj9ec9pGyT"}],"enumerator":"1","key":"vK19EXJLxS"},{"type":"heading","depth":3,"position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"children":[{"type":"text","value":"Step 5: Connecting to your VM via SSH","position":{"start":{"line":126,"column":1},"end":{"line":126,"column":1}},"key":"Gu0z5Mbo0r"}],"identifier":"step-5-connecting-to-your-vm-via-ssh","label":"Step 5: Connecting to your VM via SSH","html_id":"step-5-connecting-to-your-vm-via-ssh","implicit":true,"key":"VbfilQBckZ"},{"type":"paragraph","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"You can access the VM securely through the private network via SSH using ","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"t1MfUBxdzr"},{"type":"strong","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"children":[{"type":"text","value":"Identity-Aware Proxy (IAP)","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"GltyPpiCrg"}],"key":"dU3XKjq8PE"},{"type":"text","value":". We include a port-forwarding flag (","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"nNbzhPsdfi"},{"type":"inlineCode","value":"-L 8080:localhost:8080","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"Sm5AFwWxqP"},{"type":"text","value":") so you can open JupyterLab in your local browser:","position":{"start":{"line":128,"column":1},"end":{"line":128,"column":1}},"key":"nGT3kvWoTk"}],"key":"oONaI7G3Y4"},{"type":"code","lang":"bash","value":"gcloud compute ssh ${VM_NAME} \\\n    --zone=${ZONE} \\\n    --tunnel-through-iap \\\n    -- -L 8080:localhost:8080","key":"Pg1UFJTdPV"},{"type":"paragraph","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"children":[{"type":"text","value":"Now you can run commands like ","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"nGPLDhbvdQ"},{"type":"inlineCode","value":"nvidia-smi","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"hRBG3Jopb4"},{"type":"text","value":" on your VM to check the GPU information.","position":{"start":{"line":137,"column":1},"end":{"line":137,"column":1}},"key":"cPr5yNcNQK"}],"key":"QnnZlsrDwX"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/hands-on2-gcloud-vm--938d04e13cb8bcfe219c22eb15b90cd5.png","alt":"gcloud VM SSH output","align":"center","key":"xm48t7e3Vm","urlSource":"./images/hands-on2-gcloud-vm-ssh.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"children":[{"type":"text","value":"Screenshot: L4 GPU VM successfully connected to via SSH using ","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"imwgqW3TKt"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":143,"column":1},"end":{"line":143,"column":1}},"key":"SZjNocuV3H"}],"key":"m4NAvNbHdb"}],"key":"fA82e2LCh6"}],"enumerator":"2","key":"ayjL2igLKi"},{"type":"heading","depth":3,"position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"children":[{"type":"text","value":"Step 6: Automating Multiple VMs with a Bash Script","position":{"start":{"line":146,"column":1},"end":{"line":146,"column":1}},"key":"hTWyVlZSST"}],"identifier":"step-6-automating-multiple-vms-with-a-bash-script","label":"Step 6: Automating Multiple VMs with a Bash Script","html_id":"step-6-automating-multiple-vms-with-a-bash-script","implicit":true,"key":"pbE0GkaxFu"},{"type":"paragraph","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"foOqouOKjg"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"IvyZtL1cRw"},{"type":"text","value":" CLI enables automating large-scale tasks. You can use a bash script to launch multiple VM instances simultaneously for parallel experiments.","position":{"start":{"line":148,"column":1},"end":{"line":148,"column":1}},"key":"uSDJcRKVDD"}],"key":"sloJRrL94m"},{"type":"paragraph","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"strong","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"children":[{"type":"text","value":"Script to create 3 VMs:","position":{"start":{"line":150,"column":1},"end":{"line":150,"column":1}},"key":"uffL202oZn"}],"key":"PrGyHrCmPI"}],"key":"KTZYWgeYYd"},{"type":"code","lang":"bash","value":"# This loop provisions 3 instances in the background\nfor i in {1..3}\ndo\n   gcloud compute instances create \"experiment-vm-$i\" \\\n       --zone=europe-west4-a \\\n       --machine-type=g2-standard-4 \\\n       --accelerator=\"type=nvidia-l4,count=1\" \\\n       --image-family=common-cu128-ubuntu-2204-nvidia-570 \\\n       --image-project=deeplearning-platform-release \\\n       --maintenance-policy=TERMINATE \\\n       --network=${AIMSUSERNAME}-vpc &\ndone\nwait\necho \"All VM instances have been deployed.\"","key":"iwwaXz5imO"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/hands-on2-gcloud-bat-7c1f2345abc78d424c33a23e9c7f2333.png","alt":"gcloud batch VMs creation","align":"center","key":"agAOjALb3Y","urlSource":"./images/hands-on2-gcloud-batch-vms-list.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"Screenshot: Multiple L4 GPU VMs created and queried successfully using ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"xwfIEZD8zA"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"JZF37dIe0O"}],"key":"mXvYz343YD"}],"key":"AF4jjpRUlU"}],"enumerator":"3","key":"kBl8ZJw8yd"},{"type":"heading","depth":3,"position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"text","value":"Step 7: Resource Cleanup","position":{"start":{"line":176,"column":1},"end":{"line":176,"column":1}},"key":"uT6zeVuB1B"}],"identifier":"step-7-resource-cleanup","label":"Step 7: Resource Cleanup","html_id":"step-7-resource-cleanup","implicit":true,"key":"RiBNx6db2c"},{"type":"admonition","kind":"danger","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Danger","key":"vqt7yx2a4C"}],"key":"MZzoo60VJT"},{"type":"paragraph","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"children":[{"type":"text","value":"To terminate all charges and return your project to an empty state, you must delete the resources in the correct order.","position":{"start":{"line":179,"column":1},"end":{"line":179,"column":1}},"key":"RMgV3XjvVn"}],"key":"s4zAcymuUi"},{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"This is important for cost management to avoid burning your GCP credits.","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"o8axeDCG41"}],"key":"gbif9sHzGn"}],"key":"bxlP5FRyF9"},{"type":"paragraph","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"strong","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"children":[{"type":"text","value":"Part A: Delete all VM instances","position":{"start":{"line":184,"column":1},"end":{"line":184,"column":1}},"key":"eh2NPvvrXF"}],"key":"u44DqBA1Wi"}],"key":"Yg2C5Vx7x7"},{"type":"code","lang":"bash","value":"gcloud compute instances delete $(gcloud compute instances list --format=\"value(name)\") --quiet --zone=${ZONE}","key":"JUQ3WFfi8P"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/hands-on2-gcloud-del-16e3a5071ddc647469e9e4a533433b4b.png","alt":"gcloud VMs deletion and resource cleanup","align":"center","key":"laXihmvuoD","urlSource":"./images/hands-on2-gcloud-delete-vms.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"children":[{"type":"text","value":"Screenshot: VMs deleted successfully.","position":{"start":{"line":194,"column":1},"end":{"line":194,"column":1}},"key":"dvofMZs1At"}],"key":"klQhk3hcLx"}],"key":"qqNb9e5jxG"}],"enumerator":"4","key":"UIHcOB6bH9"},{"type":"paragraph","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"strong","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"children":[{"type":"text","value":"Part B: Delete Networking Infrastructure","position":{"start":{"line":197,"column":1},"end":{"line":197,"column":1}},"key":"DGJ4P42fV2"}],"key":"Ma6GtP8Kwe"}],"key":"SCbKRhXnde"},{"type":"code","lang":"bash","value":"# 1. Delete the NAT and Cloud Router\ngcloud compute routers nats delete ${AIMSUSERNAME}-nat-config --router=${AIMSUSERNAME}-router-${REGION} --region=${REGION} --quiet\ngcloud compute routers delete ${AIMSUSERNAME}-router-${REGION} --region=${REGION} --quiet\n\n# 2. Delete the Firewall rule\ngcloud compute firewall-rules delete ${AIMSUSERNAME}-fw-ssh --quiet\n\n# 3. Delete the VPC Network\ngcloud compute networks delete ${AIMSUSERNAME}-vpc --quiet","key":"vlWgd1tECr"},{"type":"thematicBreak","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"JMJEVSnucn"},{"type":"heading","depth":2,"position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"ðŸ”‘ Key Takeaways","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"jQuMatC8A7"}],"identifier":"id-key-takeaways","label":"ðŸ”‘ Key Takeaways","html_id":"id-key-takeaways","implicit":true,"key":"p4kqFLxG3c"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":215,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using the ","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"fSU8BqgxKP"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"N2XW9183Kr"},{"type":"text","value":" CLI makes infrastructure deployment repeatable and scriptable, allowing you to provision complex networking and high-performance compute resources with a single command.","position":{"start":{"line":215,"column":1},"end":{"line":215,"column":1}},"key":"wJeNm8wXAD"}],"key":"gAmRm78xnq"}],"key":"K0Vb7E8fW6"},{"type":"listItem","spread":true,"position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using variables like ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"IPYzRUFYDb"},{"type":"inlineCode","value":"AIMSUSERNAME","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"zEpqr1sZxu"},{"type":"text","value":", ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"LDAgf3KWAI"},{"type":"inlineCode","value":"REGION","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"KQCu2vPUJ3"},{"type":"text","value":", and ","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"CEFpPTsMGY"},{"type":"inlineCode","value":"ZONE","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"KvPbz87Q5u"},{"type":"text","value":" ensures your scripts are flexible and easily adaptable.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"CwM2VlX5L9"}],"key":"SFeuefYIML"}],"key":"Tom1qBQADz"},{"type":"listItem","spread":true,"position":{"start":{"line":217,"column":1},"end":{"line":218,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"To avoid residual charges for cost management, you must return the project to a blank state by deleting not only the VM instance but also the associated networking components like the Cloud NAT, Router, and VPC.","position":{"start":{"line":217,"column":1},"end":{"line":217,"column":1}},"key":"EbI1E2HAvU"}],"key":"Td1OUuJSrC"}],"key":"gm7oihLEoj"}],"key":"wyc6NWVfMU"},{"type":"heading","depth":2,"position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"children":[{"type":"text","value":"ðŸš€ Whatâ€™s Next","position":{"start":{"line":219,"column":1},"end":{"line":219,"column":1}},"key":"XKeeURI4fL"}],"identifier":"id-whats-next","label":"ðŸš€ Whatâ€™s Next","html_id":"id-whats-next","implicit":true,"key":"wvrid9KDuf"},{"type":"paragraph","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"In the next part, we will run a full AI experiment on a GPU VM to fine-tune a small language model with 1 billion parameters (","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"dcy0gGYLBt"},{"type":"strong","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"children":[{"type":"text","value":"Gemma 1B","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"fHtX0dsw7G"}],"key":"T7JbwmqmGy"},{"type":"text","value":"). This hands-on session will introduce you to leveraging GCP services  to manage end-to-end machine learning workflows.","position":{"start":{"line":221,"column":1},"end":{"line":221,"column":1}},"key":"PgxQfNufe6"}],"key":"ZGW2bqvu3X"}],"key":"SlC0p9W0rg"}],"key":"XnhbRKs4aL"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Hands-On 01: Create a VM via GCP Console","url":"/part1-gcp-foundations/hands-on-gcp-console","group":"Part 1 - GCP Foundations"},"next":{"title":"Introduction","url":"/part2-running-experiments-on-gcp-vms","group":"Part 2 - Running Experiments On GCP VMs"}}},"domain":"http://localhost:3000"}