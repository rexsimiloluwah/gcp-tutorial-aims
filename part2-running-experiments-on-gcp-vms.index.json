{"version":3,"kind":"Article","sha256":"f847b5b9268f00d785c37d00d4e0546b7d8bd59e2f5d86b28f14fc852da1cc28","slug":"part2-running-experiments-on-gcp-vms.index","location":"/part2-running-experiments-on-gcp-vms/index.md","dependencies":[],"frontmatter":{"title":"Introduction","content_includes_title":false,"authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/blob/main/part2-running-experiments-on-gcp-vms/index.md","edit_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/edit/main/part2-running-experiments-on-gcp-vms/index.md","exports":[{"format":"md","filename":"index.md","url":"/gcp-tutorial-aims/build/index-54c348ba2c3a6488dbf6eea08508c79e.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Running AI Experiments on GCP VMs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"In2JWMOstq"}],"identifier":"running-ai-experiments-on-gcp-vms","label":"Running AI Experiments on GCP VMs","html_id":"running-ai-experiments-on-gcp-vms","implicit":true,"key":"zfXDhCAiaW"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When a machine learning experiment outgrows your laptop, because the model is too large, training takes too long, or you need a GPU, the natural next step is to move it to the cloud.\nGCP virtual machines (VMs) give you on-demand access to powerful hardware, including modern GPUs like the NVIDIA L4, without the cost of owning physical hardware.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"eC97fxLAQn"}],"key":"oC8xLjJNPG"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Running experiments on a remote VM is conceptually simple: it is just a Linux machine you can SSH into and run Python code on. But there are a few things worth understanding before you get started.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"qSXuRkRpcN"}],"key":"xsuGcjD4XQ"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Reproducible Environments","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"U2gBvmVfE3"}],"identifier":"reproducible-environments","label":"Reproducible Environments","html_id":"reproducible-environments","implicit":true,"key":"SEDHyJj1uM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Code that works locally often fails on a VM due to different Python versions or package versions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"IYrm9vT39r"}],"key":"bVAqy92oAa"}],"key":"JnOfhSRfCK"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hence it is important to use package managers like ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Fd2mIWBjsM"},{"type":"inlineCode","value":"uv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aZnyT0Ycwq"},{"type":"text","value":" or ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Av1AKHE6eB"},{"type":"inlineCode","value":"poetry","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"kVk5Xz8gip"},{"type":"text","value":" to automate the installation, configuration, and management of software dependencies, ensuring consistency and reproducibility.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"uXLhY4vL8k"}],"key":"otrb5n4CzN"}],"key":"uVnSxZXgmL"}],"key":"dRDtsZ0yox"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Persistent Storage","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"ykgCQVUk9V"}],"identifier":"persistent-storage","label":"Persistent Storage","html_id":"persistent-storage","implicit":true,"key":"Swq0c0AN7L"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"VM disks are ephemeral. When you delete the VM, everything else is deleted.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"EInMianJZc"}],"key":"sFFyWJyiSC"}],"key":"fLKrubwnVZ"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It is important to always write outputs, checkpoints, and logs to a persistent object storage like Google Cloud Storage (GCS) during or after training so they persist independently of the VM.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"a9o3ZS1CMT"}],"key":"AFgcBIvTJL"}],"key":"MK3PIbTY3G"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Think of the VM as temporary compute and GCS as permanent storage.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"KoDK7Ua49c"}],"key":"Bc1islcTh6"}],"key":"jijOIEe11s"}],"key":"Gl1UwUpEdY"},{"type":"heading","depth":3,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Long-Running Jobs","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"uNH6G9tVbC"}],"identifier":"long-running-jobs","label":"Long-Running Jobs","html_id":"long-running-jobs","implicit":true,"key":"HLtK46q9yv"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Training machine learning models can take anywhere from minutes, for small models like XGBoost, to hours or even days for models like transformers or large language models.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"vOtOZiE72c"}],"key":"B24v2tNues"}],"key":"e6qqSGk3sR"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Keeping an SSH connection open for the entire duration is fragile. A dropped connection can kill the training process.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"kdYinv5DLj"}],"key":"dlSpHBOuZM"}],"key":"WFD9bV3maT"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can use a tool like ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"fY79tG1zZx"},{"type":"inlineCode","value":"tmux","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"kMvJaB5p2T"},{"type":"text","value":" to keep your process running on the VM even if your SSH session disconnects.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"yKxS2K9Tb1"}],"key":"jYNhxSqUt4"}],"key":"zQIL2MkWYY"}],"key":"Dk1RH3LRV3"},{"type":"heading","depth":3,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Experiment Monitoring and Logging","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"zdTjPC4cA6"}],"identifier":"experiment-monitoring-and-logging","label":"Experiment Monitoring and Logging","html_id":"experiment-monitoring-and-logging","implicit":true,"key":"iMowbgfl72"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Experiment monitoring is the practice of logging and visualizing metrics as a model trains, giving you a live record of how your experiment is progressing.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"tZz8qP1ZwY"}],"key":"Q4NcDT2HMo"}],"key":"HdElxgGGPO"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On a remote VM, you cannot just watch your terminal, so you need a tool that logs metrics to a dashboard you can access from anywhere.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"H2MQok0RVK"}],"key":"ClXSsTLeXT"}],"key":"HbWEeGzi3Z"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tools like ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"kPGloCZlWU"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Weights & Biases","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"oZWGJ4Hzvb"}],"key":"zqDbIFXmNP"},{"type":"text","value":", ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"p0NV4oc3gs"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Tensorboard","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"gPWPnmPNrI"}],"key":"QdXQjIyn3A"},{"type":"text","value":", or ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"sa16rMhUy3"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"MLFlow","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"tImFGUpzES"}],"key":"ry0gib3dFu"},{"type":"text","value":" automatically track metrics like loss, accuracy, and learning rate, hardware utilization, and maintain a history of every experiment you run.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"NXCImseWl5"}],"key":"FgIUkh0TVd"}],"key":"bLBDK8sPDA"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This gives you a centralized record of all your experiments, making it easy to compare runs, spot regressions, and share results with others.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"bb1BrzKQxZ"}],"key":"wpPxS0q00t"}],"key":"X7pnUX5lFz"}],"key":"LTJOUcdXLD"},{"type":"heading","depth":3,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Cost Management","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"JLieAE2aLi"}],"identifier":"cost-management","label":"Cost Management","html_id":"cost-management","implicit":true,"key":"yuGdXltPoM"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"VMs are billed by the second. An idle VM costs the same as a busy one.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"lz39e3aoJe"}],"key":"iFT3QoR11Q"}],"key":"utmU1lFLGE"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Always stop/delete your VM when an experiment is done.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"wsxhRNFZ0H"}],"key":"SzyT4cPjrs"}],"key":"BEVDfLPNWR"}],"key":"S18RtcrmFO"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"bE8nOurXrj"}],"key":"tnrTO6PK7w"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"GPU VMs are significantly more expensive than CPU VMs. An NVIDIA L4 instance costs roughly $0.70/hour. Always double-check that your VM has been deleted after a session by running gcloud compute instances list.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"ZDNr186J1w"}],"key":"u1VFIMmiIZ"}],"key":"SCZO5GLbJ2"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"IwGU9Ur3KW"}],"key":"kLLQCQ0DAb"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Never store API keys or tokens directly in your code or commit them to GitHub. Use a .env file listed in .gitignore and load credentials at runtime.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"DUbOdS0OhW"}],"key":"kDk5EO0FeF"}],"key":"EHFGmfKNyw"},{"type":"thematicBreak","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"lkYcTsdWyO"},{"type":"heading","depth":2,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"ðŸš€ Whatâ€™s Next?","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"mctvelwU3R"}],"identifier":"id-whats-next","label":"ðŸš€ Whatâ€™s Next?","html_id":"id-whats-next","implicit":true,"key":"fSchTTLxmb"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"In the hands-on session that follows, you will run a complete end-to-end ML experiment on a GCP VM with an NVIDIA L4 GPU. This will involve:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"msBGi7npE9"}],"key":"YO3g7EUASU"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":53,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fine-tuning ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"kNsYHlPQZ9"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Gemma 3 1B","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"XsJIkdPFVZ"}],"key":"u3V2DmHP0L"},{"type":"text","value":" on the Dolly-15k instruction dataset using LoRA.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"qqVSCX5tXL"}],"key":"C4DbiMyovl"}],"key":"x11qSsx1IN"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tracking experiments in real time with ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"WG173H4VRm"},{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Weights & Biases","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"omwFyaD6sS"}],"key":"qKllBOwi3c"}],"key":"TyoED591xY"}],"key":"w16HP0Wwvs"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Persisting checkpoints and outputs to GCS","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"R2N1ClOXAz"}],"key":"cfW8BCNEIc"}],"key":"Y8xwrytONa"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Running evaluation and inference on the trained model","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"w3n1LpD0qD"}],"key":"TZCI5porOd"}],"key":"lrUWPg2BBt"}],"key":"MCM773zv2w"}],"key":"sdlHQj7fr8"}],"key":"qhrPnfrdV0"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","url":"/part1-gcp-foundations/hands-on-gcloud-cli","group":"Part 1 - GCP Foundations"},"next":{"title":"Hands-On 01: Fine-tuning a Small Language Model (Gemma 3 1B) on a GCP VM","url":"/part2-running-experiments-on-gcp-vms/hands-on-running-ai-experiments-on-gcp-vms","group":"Part 2 - Running Experiments On GCP VMs"}}},"domain":"http://localhost:3000"}