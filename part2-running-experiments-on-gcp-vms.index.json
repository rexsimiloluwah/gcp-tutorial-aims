{"version":3,"kind":"Article","sha256":"f847b5b9268f00d785c37d00d4e0546b7d8bd59e2f5d86b28f14fc852da1cc28","slug":"part2-running-experiments-on-gcp-vms.index","location":"/part2-running-experiments-on-gcp-vms/index.md","dependencies":[],"frontmatter":{"title":"Introduction","content_includes_title":false,"authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/blob/main/part2-running-experiments-on-gcp-vms/index.md","edit_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/edit/main/part2-running-experiments-on-gcp-vms/index.md","exports":[{"format":"md","filename":"index.md","url":"/build/index-a9409bcda15d93842516fb4fab41ea16.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Running AI Experiments on GCP VMs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"CxCWGvlIUK"}],"identifier":"running-ai-experiments-on-gcp-vms","label":"Running AI Experiments on GCP VMs","html_id":"running-ai-experiments-on-gcp-vms","implicit":true,"key":"Ev4QQNlh0z"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When a machine learning experiment outgrows your laptop, because the model is too large, training takes too long, or you need a GPU, the natural next step is to move it to the cloud.\nGCP virtual machines (VMs) give you on-demand access to powerful hardware, including modern GPUs like the NVIDIA L4, without the cost of owning physical hardware.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"gcV6Dt34ew"}],"key":"BpN5MJbrFD"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Running experiments on a remote VM is conceptually simple: it is just a Linux machine you can SSH into and run Python code on. But there are a few things worth understanding before you get started.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"epCqfvGikG"}],"key":"FURxDBuypb"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Reproducible Environments","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"Q5wwFyd8jI"}],"identifier":"reproducible-environments","label":"Reproducible Environments","html_id":"reproducible-environments","implicit":true,"key":"WykUsl5467"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Code that works locally often fails on a VM due to different Python versions or package versions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"JalqmpteWy"}],"key":"M1ipIJV4ll"}],"key":"D5sZtOww0l"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hence it is important to use package managers like ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"jub97aCf9N"},{"type":"inlineCode","value":"uv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"xdGtRHx9yh"},{"type":"text","value":" or ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"HgH5H6I2Md"},{"type":"inlineCode","value":"poetry","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"UtTDWphR8x"},{"type":"text","value":" to automate the installation, configuration, and management of software dependencies, ensuring consistency and reproducibility.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yTvQI1tNEU"}],"key":"YNSZWhRxIO"}],"key":"Wh6V8M3PiY"}],"key":"up1qwrsjir"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Persistent Storage","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"AdWEXHNOjU"}],"identifier":"persistent-storage","label":"Persistent Storage","html_id":"persistent-storage","implicit":true,"key":"cmfg7s4kop"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"VM disks are ephemeral. When you delete the VM, everything else is deleted.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"GlEjGq78Gy"}],"key":"QNBXoU7jh9"}],"key":"KorbO4UPGk"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It is important to always write outputs, checkpoints, and logs to a persistent object storage like Google Cloud Storage (GCS) during or after training so they persist independently of the VM.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"l1hTtoFAnA"}],"key":"rpAI0qyOK1"}],"key":"kJFjt9ch1g"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Think of the VM as temporary compute and GCS as permanent storage.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"Kyz52agOF3"}],"key":"yTCDZ1KRHL"}],"key":"bEsw1lCMpj"}],"key":"Ik0IOFdCPR"},{"type":"heading","depth":3,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Long-Running Jobs","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"qPQV4o6y8s"}],"identifier":"long-running-jobs","label":"Long-Running Jobs","html_id":"long-running-jobs","implicit":true,"key":"GSdVnNwEkR"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Training machine learning models can take anywhere from minutes, for small models like XGBoost, to hours or even days for models like transformers or large language models.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"JFSgHfZj1x"}],"key":"dGVlR6zpX7"}],"key":"m0icxqcsDI"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Keeping an SSH connection open for the entire duration is fragile. A dropped connection can kill the training process.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"l6OWJwxt96"}],"key":"U08iSRG5x4"}],"key":"PcVJS6cdQ8"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can use a tool like ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"kL2P2GiwND"},{"type":"inlineCode","value":"tmux","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Lqp9JFSt5o"},{"type":"text","value":" to keep your process running on the VM even if your SSH session disconnects.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"woOqpzqBxs"}],"key":"AG1WdUUv2R"}],"key":"ojyvFnnUkK"}],"key":"G6vna4pCtS"},{"type":"heading","depth":3,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Experiment Monitoring and Logging","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"o2wOlT3Iff"}],"identifier":"experiment-monitoring-and-logging","label":"Experiment Monitoring and Logging","html_id":"experiment-monitoring-and-logging","implicit":true,"key":"qD3OjZEKJe"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Experiment monitoring is the practice of logging and visualizing metrics as a model trains, giving you a live record of how your experiment is progressing.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"VWXwCrq5RF"}],"key":"OfawUQdwQ1"}],"key":"x77GzyL1kc"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On a remote VM, you cannot just watch your terminal, so you need a tool that logs metrics to a dashboard you can access from anywhere.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"rmQrycroDx"}],"key":"vEbGZmJbj6"}],"key":"mDdMTzbZ90"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tools like ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"oJ9zLdWIOi"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Weights & Biases","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"VAWiyp508x"}],"key":"gBNdX4DWUn"},{"type":"text","value":", ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"P9BXLcCpda"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Tensorboard","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"OYov8mpGpm"}],"key":"viYtzwMRDC"},{"type":"text","value":", or ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"fclre96syU"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"MLFlow","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"dgyVEXYQEB"}],"key":"fbYlzXwvnY"},{"type":"text","value":" automatically track metrics like loss, accuracy, and learning rate, hardware utilization, and maintain a history of every experiment you run.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"cZZxygdSKK"}],"key":"eETBv1K1rB"}],"key":"bRQPlyCdg3"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This gives you a centralized record of all your experiments, making it easy to compare runs, spot regressions, and share results with others.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"U26RLrsH3t"}],"key":"J8zXExiauy"}],"key":"rDgpDhF5rr"}],"key":"cbuWmW9l68"},{"type":"heading","depth":3,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Cost Management","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"hycIs2X0Hn"}],"identifier":"cost-management","label":"Cost Management","html_id":"cost-management","implicit":true,"key":"fV9OPbyga5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"VMs are billed by the second. An idle VM costs the same as a busy one.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"LYjXqA7cZO"}],"key":"cLARx0u12n"}],"key":"cOH5sad9j0"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Always stop/delete your VM when an experiment is done.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"eretaZh9Y7"}],"key":"HkDFnttlUq"}],"key":"UNnmA0CAdz"}],"key":"GUnKTnMGLc"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"pydMZAVcCD"}],"key":"RSmRwdcXbW"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"GPU VMs are significantly more expensive than CPU VMs. An NVIDIA L4 instance costs roughly $0.70/hour. Always double-check that your VM has been deleted after a session by running gcloud compute instances list.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"LcAPJF72Dk"}],"key":"sg3UlqOYQt"}],"key":"sKWrYAHTv9"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"SPpoC2pCpj"}],"key":"VCOldxXW6U"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Never store API keys or tokens directly in your code or commit them to GitHub. Use a .env file listed in .gitignore and load credentials at runtime.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"yU7O7XRTCw"}],"key":"uzIfMVIoWE"}],"key":"UdB3CJkuoY"},{"type":"thematicBreak","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"wrGboehhWz"},{"type":"heading","depth":2,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"ðŸš€ Whatâ€™s Next?","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"aTVhshu4kt"}],"identifier":"id-whats-next","label":"ðŸš€ Whatâ€™s Next?","html_id":"id-whats-next","implicit":true,"key":"xbv7JVs5To"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"In the hands-on session that follows, you will run a complete end-to-end ML experiment on a GCP VM with an NVIDIA L4 GPU. This will involve:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"se4Fz0EIMA"}],"key":"kQrdijtRZS"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":53,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fine-tuning ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"MyUJTzR0AQ"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Gemma 3 1B","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"rbywxOXlBQ"}],"key":"dmmZ0rNKdA"},{"type":"text","value":" on the Dolly-15k instruction dataset using LoRA.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"HLpCU3IDEx"}],"key":"bu1iXT4f17"}],"key":"hwHs50nNpu"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tracking experiments in real time with ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"BsFQvy07aX"},{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Weights & Biases","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"PJaKoKZrA4"}],"key":"pAa2Eng80x"}],"key":"k7wnMNpfsb"}],"key":"wB1lE7ZaWY"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Persisting checkpoints and outputs to GCS","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"FdAm6QcA1B"}],"key":"ThnaRn1Zqj"}],"key":"LTKWxvPNCL"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Running evaluation and inference on the trained model","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"CSCynALsQb"}],"key":"QbG8nK1iyo"}],"key":"h1xQ838Fum"}],"key":"GqNImbgAaw"}],"key":"U8C2NYF7ju"}],"key":"tkAQqOvbCK"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","url":"/part1-gcp-foundations/hands-on-gcloud-cli","group":"Part 1 - GCP Foundations"},"next":{"title":"Hands-On 01: Fine-tuning a Small Language Model (Gemma 3 1B) on a GCP VM","url":"/part2-running-experiments-on-gcp-vms/hands-on-running-ai-experiments-on-gcp-vms","group":"Part 2 - Running Experiments On GCP VMs"}}},"domain":"http://localhost:3000"}