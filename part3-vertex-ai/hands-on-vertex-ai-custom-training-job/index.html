<!DOCTYPE html><html lang="en" class="" style="scroll-padding:60px"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width,initial-scale=1"/><title>Hands-On 01: Vertex AI Custom Training Jobs - AIMS GCP ML Tutorial</title><meta property="og:title" content="Hands-On 01: Vertex AI Custom Training Jobs - AIMS GCP ML Tutorial"/><meta name="generator" content="mystmd"/><meta name="description" content="A no-fluff guide to using GCP for ML experiments and research"/><meta property="og:description" content="A no-fluff guide to using GCP for ML experiments and research"/><meta name="keywords" content="GCP, AI, GPU, Machine Learning, Research, Experiments, MLOps"/><meta name="image" content="/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png"/><meta property="og:image" content="/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png"/><link rel="stylesheet" href="/gcp-tutorial-aims/build/_assets/app-2K3KGISG.css"/><link rel="stylesheet" href="/gcp-tutorial-aims/build/_assets/thebe-core-VKVHG5VY.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/jupyter-matplotlib@0.11.3/css/mpl_widget.css"/><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.css"/><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.15.2/dist/katex.min.css" integrity="sha384-MlJdn/WNKDGXveldHDdyRP1R4CTHr3FeuDNfhsLPYrq2t0UBkUdK2jyTnXPEK1NQ" crossorigin="anonymous"/><link rel="icon" href="/gcp-tutorial-aims/favicon.ico"/><link rel="stylesheet" href="/gcp-tutorial-aims/myst-theme.css"/><script>
  const savedTheme = localStorage.getItem("myst:theme");
  const theme = window.matchMedia("(prefers-color-scheme: light)").matches ? 'light' : 'dark';
  const classes = document.documentElement.classList;
  const hasAnyTheme = classes.contains('light') || classes.contains('dark');
  if (!hasAnyTheme) classes.add(savedTheme ?? theme);
</script></head><body class="m-0 transition-colors duration-500 bg-white dark:bg-stone-900"><div class="myst-skip-to-article fixed top-1 left-1 h-[0px] w-[0px] focus-within:z-40 focus-within:h-auto focus-within:w-auto bg-white overflow-hidden focus-within:p-2 focus-within:ring-1" aria-label="skip to content options"><a href="#skip-to-frontmatter" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article frontmatter</a><a href="#skip-to-article" class="myst-skip-to-link block px-2 py-1 text-black underline">Skip to article content</a></div><dialog id="myst-no-css" style="position:fixed;left:0px;top:0px;width:100%;height:100vh;font-size:4rem;padding:1rem;color:black;background:white"><strong>Site not loading correctly?</strong><p>This may be due to an incorrect <code>BASE_URL</code> configuration. See<!-- --> <a href="https://mystmd.org/guide/deployment#deploy-base-url">the MyST Documentation</a> <!-- -->for reference.</p><script>
    (() => {
            // Test for has-styling variable set by the MyST stylesheet
            const node = document.currentScript.parentNode;
            const hasCSS = window.getComputedStyle(node).getPropertyValue("--has-styling");
            if (hasCSS === ""){
                    node.showModal();
            }

    })()
</script></dialog><div class="myst-top-nav bg-white/80 backdrop-blur dark:bg-stone-900/80 shadow dark:shadow-stone-700 p-3 md:px-8 sticky w-full top-0 z-30 h-[60px]"><nav class="myst-top-nav-bar flex items-center justify-between flex-nowrap max-w-[1440px] mx-auto"><div class="flex flex-row xl:min-w-[19.5rem] mr-2 sm:mr-7 justify-start items-center shrink-0"><div class="block xl:hidden"><button class="myst-top-nav-menu-button flex items-center justify-center border-stone-400 text-stone-800 hover:text-stone-900 dark:text-stone-200 hover:dark:text-stone-100 w-10 h-10"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem"><path fill-rule="evenodd" d="M3 6.75A.75.75 0 0 1 3.75 6h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 6.75ZM3 12a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75A.75.75 0 0 1 3 12Zm0 5.25a.75.75 0 0 1 .75-.75h16.5a.75.75 0 0 1 0 1.5H3.75a.75.75 0 0 1-.75-.75Z" clip-rule="evenodd"></path></svg><span class="sr-only">Open Menu</span></button></div><a class="myst-home-link flex items-center ml-3 dark:text-white w-fit md:ml-5 xl:ml-7" href="/gcp-tutorial-aims/"><span class="text-md sm:text-xl tracking-tight sm:mr-5">AIMS GCP ML Tutorial</span></a></div><div class="flex items-center flex-grow w-auto"><div class="flex-grow hidden text-md lg:block"></div><div class="flex-grow block"></div><button type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R75cp:" data-state="closed" class="myst-search-bar flex items-center h-10 aspect-square sm:w-64 text-left text-gray-600 dark:text-gray-300 border border-gray-300 dark:border-gray-600 rounded-lg bg-gray-50 dark:bg-gray-700 myst-search-bar-disabled hover:ring-blue-500 dark:hover:ring-blue-500 hover:border-blue-500 dark:hover:border-blue-500"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="p-2.5 h-10 w-10 aspect-square"><path fill-rule="evenodd" d="M10.5 3.75a6.75 6.75 0 1 0 0 13.5 6.75 6.75 0 0 0 0-13.5ZM2.25 10.5a8.25 8.25 0 1 1 14.59 5.28l4.69 4.69a.75.75 0 1 1-1.06 1.06l-4.69-4.69A8.25 8.25 0 0 1 2.25 10.5Z" clip-rule="evenodd"></path></svg><span class="myst-search-text-placeholder hidden sm:block grow">Search</span><div aria-hidden="true" class="myst-search-shortcut items-center hidden mx-1 font-mono text-sm text-gray-600 dark:text-gray-300 sm:flex gap-x-1"><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none hide-mac">CTRL</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none show-mac">⌘</kbd><kbd class="px-2 py-1 border border-gray-300 dark:border-gray-600 rounded-md shadow-[0px_2px_0px_0px_rgba(0,0,0,0.08)] dark:shadow-none ">K</kbd><script>
;(() => {
const script = document.currentScript;
const root = script.parentElement;

const isMac = /mac/i.test(
      window.navigator.userAgentData?.platform ?? window.navigator.userAgent,
    );
root.querySelectorAll(".hide-mac").forEach(node => {node.classList.add(isMac ? "hidden" : "block")});
root.querySelectorAll(".show-mac").forEach(node => {node.classList.add(!isMac ? "hidden" : "block")});
})()</script></div></button><button class="myst-theme-button theme rounded-full aspect-square border border-stone-700 dark:border-white hover:bg-neutral-100 border-solid overflow-hidden text-stone-700 dark:text-white hover:text-stone-500 dark:hover:text-neutral-800 w-10 h-10 mx-3" title="Toggle theme between light and dark mode" aria-label="Toggle theme between light and dark mode"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-moon-icon h-full w-full p-0.5 hidden dark:block"><path fill-rule="evenodd" d="M9.528 1.718a.75.75 0 0 1 .162.819A8.97 8.97 0 0 0 9 6a9 9 0 0 0 9 9 8.97 8.97 0 0 0 3.463-.69.75.75 0 0 1 .981.98 10.503 10.503 0 0 1-9.694 6.46c-5.799 0-10.5-4.7-10.5-10.5 0-4.368 2.667-8.112 6.46-9.694a.75.75 0 0 1 .818.162Z" clip-rule="evenodd"></path></svg><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="myst-theme-sun-icon h-full w-full p-0.5 dark:hidden"><path stroke-linecap="round" stroke-linejoin="round" d="M12 3v2.25m6.364.386-1.591 1.591M21 12h-2.25m-.386 6.364-1.591-1.591M12 18.75V21m-4.773-4.227-1.591 1.591M5.25 12H3m4.227-4.773L5.636 5.636M15.75 12a3.75 3.75 0 1 1-7.5 0 3.75 3.75 0 0 1 7.5 0Z"></path></svg></button><div class="block sm:hidden"></div><div class="hidden sm:block"></div></div></nav></div><div class="myst-primary-sidebar fixed xl:article-grid grid-gap xl:w-full xl:pointer-events-none overflow-auto max-xl:w-[75vw] max-xl:max-w-[350px] max-xl:!top-0 max-xl:h-screen hidden z-10" style="top:60px"><div class="myst-primary-sidebar-pointer pointer-events-auto xl:col-margin-left flex-col overflow-hidden max-xl:h-full hidden xl:flex"><div class="myst-primary-sidebar-nav flex-grow py-6 overflow-y-auto primary-scrollbar"><nav aria-label="Navigation" class="myst-primary-sidebar-topnav overflow-y-hidden transition-opacity lg:hidden ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="w-full px-1 dark:text-white font-medium"></div></nav><div class="my-3 border-b-2 lg:hidden"></div><nav aria-label="Table of Contents" class="myst-primary-sidebar-toc flex-grow overflow-y-hidden transition-opacity ml-3 xl:ml-0 mr-3 max-w-[350px]"><div class="myst-toc w-full px-1 dark:text-white"><a title="AIMS GCP Tutorial" class="block break-words focus:outline outline-blue-200 outline-2 rounded myst-toc-item p-2 my-1 rounded-lg hover:bg-slate-300/30 font-bold" href="/gcp-tutorial-aims/">AIMS GCP Tutorial</a><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Part 1 - GCP Foundations" class="block break-words rounded py-2 grow cursor-pointer">Part 1 - GCP Foundations</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rmpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rmpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Part 2 - Running Experiments On GCP VMs" class="block break-words rounded py-2 grow cursor-pointer">Part 2 - Running Experiments On GCP VMs</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:Rupsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:Rupsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Part 3 - Vertex AI" class="block break-words rounded py-2 grow cursor-pointer">Part 3 - Vertex AI</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R16psp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R16psp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Part 4 - Cost Management" class="block break-words rounded py-2 grow cursor-pointer">Part 4 - Cost Management</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1epsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1epsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div><div data-state="closed" class="w-full"><div class="myst-toc-item flex flex-row w-full gap-2 pl-2 my-1 text-left rounded-lg outline-none hover:bg-slate-300/30"><div title="Appendix" class="block break-words rounded py-2 grow cursor-pointer">Appendix</div><button class="self-stretch flex items-center flex-none px-1 rounded-l-md group hover:bg-slate-300/30 focus-visible:outline outline-blue-200 outline-2" aria-label="Open Folder" type="button" aria-controls="radix-:R1mpsp:" aria-expanded="false" data-state="closed"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" class="transition-transform duration-300 group-data-[state=open]:rotate-90 text-text-slate-700 dark:text-slate-100" height="1.5rem" width="1.5rem"><path fill-rule="evenodd" d="M16.28 11.47a.75.75 0 0 1 0 1.06l-7.5 7.5a.75.75 0 0 1-1.06-1.06L14.69 12 7.72 5.03a.75.75 0 0 1 1.06-1.06l7.5 7.5Z" clip-rule="evenodd"></path></svg></button></div><div data-state="closed" id="radix-:R1mpsp:" hidden="" class="pl-3 pr-[2px] collapsible-content"></div></div></div></nav></div><div class="myst-primary-sidebar-footer flex-none py-6 transition-all duration-700 translate-y-6 opacity-0 ml-3 xl:ml-0 mr-3 max-w-[350px]"><a class="myst-made-with-myst flex mx-auto text-gray-700 w-fit hover:text-blue-700 dark:text-gray-200 dark:hover:text-blue-400" href="https://mystmd.org/made-with-myst" target="_blank" rel="noreferrer"><svg style="width:24px;height:24px" xmlns="http://www.w3.org/2000/svg" viewBox="0 0 100 100" stroke="none"><g id="icon"><path fill="currentColor" d="M23.8,54.8v-3.6l4.7-0.8V17.5l-4.7-0.8V13H36l13.4,31.7h0.2l13-31.7h12.6v3.6l-4.7,0.8v32.9l4.7,0.8v3.6h-15
          v-3.6l4.9-0.8V20.8H65L51.4,53.3h-3.8l-14-32.5h-0.1l0.2,17.4v12.1l5,0.8v3.6H23.8z"></path><path fill="#F37726" d="M47,86.9c0-5.9-3.4-8.8-10.1-8.8h-8.4c-5.2,0-9.4-1.3-12.5-3.8c-3.1-2.5-5.4-6.2-6.8-11l4.8-1.6
          c1.8,5.6,6.4,8.6,13.8,8.8h9.2c6.4,0,10.8,2.5,13.1,7.5c2.3-5,6.7-7.5,13.1-7.5h8.4c7.8,0,12.7-2.9,14.6-8.7l4.8,1.6
          c-1.4,4.9-3.6,8.6-6.8,11.1c-3.1,2.5-7.3,3.7-12.4,3.8H63c-6.7,0-10,2.9-10,8.8"></path></g></svg><span class="self-center ml-2 text-sm">Made with MyST</span></a></div></div></div><main class="article-grid grid-gap"><article class="article-grid subgrid-gap col-screen article content"><div class="hidden"></div><div id="skip-to-frontmatter" aria-label="article frontmatter" class="myst-fm-block mb-8 pt-9"><div class="myst-fm-block-header flex items-center mb-5 h-6 text-sm font-light"><div class="flex-grow"></div><div class="myst-fm-block-badges"><a href="https://creativecommons.org/licenses/by/4.0/" target="_blank" rel="noopener noreferrer" class="myst-fm-license-cc-badge opacity-50 hover:opacity-100 text-inherit hover:text-inherit myst-fm-license-content" aria-label="Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-license-cc-icon myst-fm-license-cc-icon-main inline-block mx-1"><title>Content License: Creative Commons Attribution 4.0 International (CC-BY-4.0)</title><path d="M12 2.2c2.7 0 5 1 7 2.9.9.9 1.6 2 2.1 3.1.5 1.2.7 2.4.7 3.8 0 1.3-.2 2.6-.7 3.8-.5 1.2-1.2 2.2-2.1 3.1-1 .9-2 1.7-3.2 2.2-1.2.5-2.5.7-3.7.7s-2.6-.3-3.8-.8c-1.2-.5-2.2-1.2-3.2-2.1s-1.6-2-2.1-3.2-.8-2.4-.8-3.7c0-1.3.2-2.5.7-3.7S4.2 6 5.1 5.1C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C5.6 7.1 5 8 4.6 9c-.4 1-.6 2-.6 3s.2 2.1.6 3c.4 1 1 1.8 1.8 2.6S8 19 9 19.4c1 .4 2 .6 3 .6s2.1-.2 3-.6c1-.4 1.9-1 2.7-1.8 1.5-1.5 2.3-3.3 2.3-5.6 0-1.1-.2-2.1-.6-3.1-.4-1-1-1.8-1.7-2.6C16.1 4.8 14.2 4 12 4zm-.1 6.4l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.5.3-1 .4-1.5.4-.9 0-1.6-.3-2.1-.8-.5-.6-.8-1.3-.8-2.3 0-.9.3-1.7.8-2.2.6-.6 1.3-.8 2.1-.8 1.2 0 2.1.4 2.6 1.4zm5.6 0l-1.3.7c-.1-.3-.3-.5-.5-.6-.2-.1-.4-.2-.6-.2-.9 0-1.3.6-1.3 1.7 0 .5.1.9.3 1.3.2.3.5.5 1 .5.6 0 1-.3 1.2-.8l1.2.6c-.3.5-.6.9-1.1 1.1-.4.2-.9.3-1.4.3-.9 0-1.6-.3-2.1-.8s-.8-1.3-.8-2.2c0-.9.3-1.7.8-2.2.5-.5 1.2-.8 2-.8 1.2 0 2.1.4 2.6 1.4z"></path></svg><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-license-cc-icon myst-fm-license-cc-icon-by inline-block mr-1"><title>Credit must be given to the creator</title><path d="M12 2.2c2.7 0 5 .9 6.9 2.8 1.9 1.9 2.8 4.2 2.8 6.9s-.9 5-2.8 6.8c-2 1.9-4.3 2.9-7 2.9-2.6 0-4.9-1-6.9-2.9-1.8-1.7-2.8-4-2.8-6.7s1-5 2.9-6.9C7 3.2 9.3 2.2 12 2.2zM12 4c-2.2 0-4.1.8-5.6 2.3C4.8 8 4 9.9 4 12c0 2.2.8 4 2.4 5.6C8 19.2 9.8 20 12 20c2.2 0 4.1-.8 5.7-2.4 1.5-1.5 2.3-3.3 2.3-5.6 0-2.2-.8-4.1-2.3-5.7C16.1 4.8 14.2 4 12 4zm2.6 5.6v4h-1.1v4.7h-3v-4.7H9.4v-4c0-.2.1-.3.2-.4.1-.2.2-.2.4-.2h4c.2 0 .3.1.4.2.2.1.2.2.2.4zm-4-2.5c0-.9.5-1.4 1.4-1.4s1.4.5 1.4 1.4c0 .9-.5 1.4-1.4 1.4s-1.4-.5-1.4-1.4z"></path></svg></a><a href="https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial" title="GitHub Repository: rexsimiloluwa/aims-ai-gcp-tutorial" target="_blank" rel="noopener noreferrer" class="myst-fm-github-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" width="1.25rem" height="1.25rem" class="myst-fm-github-icon inline-block mr-1 opacity-60 hover:opacity-100"><path d="M12 2.5c-5.4 0-9.8 4.4-9.8 9.7 0 4.3 2.8 8 6.7 9.2.5.1.7-.2.7-.5v-1.8c-2.4.5-3.1-.6-3.3-1.1-.1-.3-.6-1.1-1-1.4-.3-.2-.8-.6 0-.6s1.3.7 1.5 1c.9 1.5 2.3 1.1 2.8.8.1-.6.3-1.1.6-1.3-2.2-.2-4.4-1.1-4.4-4.8 0-1.1.4-1.9 1-2.6-.1-.2-.4-1.2.1-2.6 0 0 .8-.3 2.7 1 .8-.2 1.6-.3 2.4-.3.8 0 1.7.1 2.4.3 1.9-1.3 2.7-1 2.7-1 .5 1.3.2 2.3.1 2.6.6.7 1 1.5 1 2.6 0 3.7-2.3 4.6-4.4 4.8.4.3.7.9.7 1.8V21c0 .3.2.6.7.5 3.9-1.3 6.6-4.9 6.6-9.2 0-5.4-4.4-9.8-9.8-9.8z"></path></svg></a></div><a href="https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/edit/main/part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md" title="Edit This Page" target="_blank" rel="noopener noreferrer" class="myst-fm-edit-link text-inherit hover:text-inherit"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-edit-icon inline-block mr-1 opacity-60 hover:opacity-100"><path stroke-linecap="round" stroke-linejoin="round" d="m16.862 4.487 1.687-1.688a1.875 1.875 0 1 1 2.652 2.652L10.582 16.07a4.5 4.5 0 0 1-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 0 1 1.13-1.897l8.932-8.931Zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0 1 15.75 21H5.25A2.25 2.25 0 0 1 3 18.75V8.25A2.25 2.25 0 0 1 5.25 6H10"></path></svg></a><div class="myst-fm-downloads-dropdown relative flex inline-block mx-1 grow-0" data-headlessui-state=""><button class="myst-fm-downloads-button relative ml-2 -mr-1" id="headlessui-menu-button-:Rs8ucp:" type="button" aria-haspopup="menu" aria-expanded="false" data-headlessui-state=""><span class="sr-only">Downloads</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.25rem" height="1.25rem" class="myst-fm-downloads-icon"><title>Download</title><path stroke-linecap="round" stroke-linejoin="round" d="M3 16.5v2.25A2.25 2.25 0 0 0 5.25 21h13.5A2.25 2.25 0 0 0 21 18.75V16.5M16.5 12 12 16.5m0 0L7.5 12m4.5 4.5V3"></path></svg></button></div></div><h1 class="myst-fm-block-title mb-0">Hands-On 01: Vertex AI Custom Training Jobs</h1><header class="myst-fm-authors-affiliations mt-4 not-prose"><div class="myst-fm-authors-list"><span class="myst-fm-author font-semibold text-sm myst-fm-author-item inline-block"><button class="myst-fm-author-popover focus:shadow-[0_0_0_2px] focus:shadow-black outline-none hover:underline" aria-label="Author Details" type="button" aria-haspopup="dialog" aria-expanded="false" aria-controls="radix-:R78ucp:" data-state="closed"><span class="myst-fm-author-name">AIMS TtT Team</span></button></span></div></header></div><div class="block my-10 lg:sticky lg:z-10 lg:h-0 lg:pt-0 lg:my-0 lg:ml-10 lg:col-margin-right" style="top:60px"><nav></nav></div><div id="skip-to-article"></div><h2 id="overview" class="relative group"><span class="heading-text">Overview</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#overview" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In the previous hands-on session, we ran the Gemma 1B fine-tuning experiment on a raw GCP VM. We had to provision the VM, SSH in, set up the environment, and manually manage the entire process. In this session we will run the exact same experiment as a <strong>Vertex AI Custom Training Job</strong>, where Vertex AI handles all the infrastructure for us. We submit a <strong>job spec</strong>, Vertex AI provisions the hardware, runs the job, and terminates everything automatically when done.</p><h2 id="learning-objectives" class="relative group"><span class="heading-text">Learning Objectives</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#learning-objectives" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>By the end of this session, you will be able to:</p><ul><li><p>Enable the Vertex AI API and set up the required permissions</p></li><li><p>Write a Vertex AI Custom Training Job config file</p></li><li><p>Submit and monitor a training job using the <code>gcloud</code> CLI</p></li></ul><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Note</div></div><div class="myst-admonition-body px-4 py-1"><p>This hands-on uses the same fine-tuning experiment from the previous session. If you want to understand the experiment in detail, including the model, dataset, and training code, refer back to <a class="link" href="/gcp-tutorial-aims/part2-running-experiments-on-gcp-vms/hands-on-running-ai-experiments-on-gcp-vms">Hands-On: Fine-Tuning Gemma 1B on a GCP VM</a>.</p></div></aside><h2 id="prerequisites" class="relative group"><span class="heading-text">Prerequisites</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#prerequisites" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p><code>gcloud</code> CLI installed and configured on your local machine</p></li><li><p>A WandB account and API key</p></li><li><p>A HuggingFace account and API token with the Gemma 3 1B model license agreement accepted.</p></li></ul><hr class="py-2 my-5 translate-y-2"/><h2 id="step-1-enable-the-vertex-ai-api" class="relative group"><span class="heading-text">Step 1: Enable the Vertex AI API</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-1-enable-the-vertex-ai-api" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Run this from your local machine to enable the Vertex AI API:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre">export PROJECT_ID=$(gcloud config get-value project)

gcloud services enable aiplatform.googleapis.com \
    --project=${PROJECT_ID}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Verify it has been enabled:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre">gcloud services list --enabled \
    --filter=&quot;name:aiplatform.googleapis.com&quot; \
    --project=${PROJECT_ID}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="step-2-grant-the-required-permissions" class="relative group"><span class="heading-text">Step 2: Grant the Required Permissions</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-2-grant-the-required-permissions" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Vertex AI training jobs run under a service account. Grant it the permissions it needs to read and write to GCS.</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre">export SERVICE_ACCOUNT=$(gcloud iam service-accounts list \
    --filter=&quot;displayName:Compute Engine default service account&quot; \
    --format=&quot;value(email)&quot; \
    --project=${PROJECT_ID})

gcloud projects add-iam-policy-binding ${PROJECT_ID} \
    --member=&quot;serviceAccount:${SERVICE_ACCOUNT}&quot; \
    --role=&quot;roles/storage.admin&quot;

gcloud projects add-iam-policy-binding ${PROJECT_ID} \
    --member=&quot;serviceAccount:${SERVICE_ACCOUNT}&quot; \
    --role=&quot;roles/aiplatform.user&quot;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><h2 id="step-3-create-the-job-config" class="relative group"><span class="heading-text">Step 3: Create the Job Config</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-3-create-the-job-config" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Vertex AI Custom Training Jobs are defined by a YAML config file that specifies the machine type, container image, and the command to run. Create a file called <code>vertex_job.yaml</code> in your project folder.</p><p>Paste the following code, replacing the placeholder values for the environment variables (<code>YOUR_HF_TOKEN</code>, <code>YOUR_WANDB_API_KEY</code>, <code>YOUR_WANDB_PROJECT</code>, <code>YOUR_GCS_BUCKET_NAME</code>) with the actual values.</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-yaml" style="white-space:pre">workerPoolSpecs:
  - machineSpec:
      machineType: g2-standard-4
      acceleratorType: NVIDIA_L4
      acceleratorCount: 1
    replicaCount: 1
    containerSpec:
      imageUri: us-docker.pkg.dev/deeplearning-platform-release/gcr.io/pytorch-gpu.2-0.py310
      command:
        - bash
        - -c
      args:
        - |
          curl -LsSf https://astral.sh/uv/install.sh | sh &amp;&amp;
          source $HOME/.local/bin/env &amp;&amp;
          git clone https://github.com/rexsimiloluwah/finetuning-gemma-1b-aims-gcp-tutorial.git &amp;&amp;
          cd finetuning-gemma-1b-aims-gcp-tutorial &amp;&amp;
          uv sync &amp;&amp;
          uv run python -m scripts.run_train data.source=gcs data.max_train_samples=10000 training.num_epochs=2 training.batch_size=8 experiment_id=exp_lora_r8_vertex
          gsutil -m cp -r outputs/ gs://$BUCKET_NAME/runs/exp_lora_r8_vertex
      env:
        - name: HF_TOKEN
          value: &lt;YOUR_HF_TOKEN&gt;
        - name: WANDB_API_KEY
          value: &lt;YOUR_WANDB_API_KEY&gt;
        - name: WANDB_PROJECT
          value: &lt;YOUR_WANDB_PROJECT&gt;
        - name: BUCKET_NAME
          value: &lt;YOUR_GCS_BUCKET_NAME&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>This configuration does the following:</p><ol start="1"><li><p>Automatically spins up a Google Cloud VM equipped with an <strong>NVIDIA L4 GPU</strong> and the necessary CUDA drivers.</p></li><li><p>Automates environment setup: clones the training code, installs the <code>uv</code> package manager, and installs all Python dependencies.</p></li><li><p>Runs the Gemma 1B fine-tuning script and automatically persists the resulting model weights and logs to your GCS bucket.</p></li></ol><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Why this container image?</div></div><div class="myst-admonition-body px-4 py-1"><p>The <code>pytorch-gpu.2-0.py310</code> image comes with PyTorch, CUDA, and common ML libraries pre-installed. This means <code>uv sync</code> only needs to install your smaller dependencies like <code>transformers</code>, <code>peft</code>, and <code>wandb</code>, rather than downloading PyTorch (873MB) and CUDA libraries from scratch on every run.</p></div></aside><aside class="myst-admonition myst-admonition-note my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-blue-500"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-blue-600 bg-blue-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-blue-600"><path stroke-linecap="round" stroke-linejoin="round" d="m11.25 11.25.041-.02a.75.75 0 0 1 1.063.852l-.708 2.836a.75.75 0 0 0 1.063.853l.041-.021M21 12a9 9 0 1 1-18 0 9 9 0 0 1 18 0Zm-9-3.75h.008v.008H12V8.25Z"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Why <code>gsutil cp</code> command at the end?</div></div><div class="myst-admonition-body px-4 py-1"><p>HuggingFace Trainer saves checkpoints locally inside the container, which is ephemeral and lost when the job finishes. The <code>gsutil cp</code> command at the end explicitly syncs the local <code>outputs/</code> directory to GCS after training completes, ensuring your checkpoints persist. This is the standard pattern for persisting outputs from Vertex AI training jobs when using HuggingFace Trainer.</p></div></aside><aside class="myst-admonition myst-admonition-warning my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-amber-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-amber-600 bg-amber-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-amber-600"><path fill-rule="evenodd" d="M9.401 3.003c1.155-2 4.043-2 5.197 0l7.355 12.748c1.154 2-.29 4.5-2.599 4.5H4.645c-2.309 0-3.752-2.5-2.598-4.5L9.4 3.003ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Warning</div></div><div class="myst-admonition-body px-4 py-1"><p>Do not commit the <code>vertex_job.yaml</code> file to GitHub with your API keys in it. Add it to .gitignore to keep your credentials safe.</p></div></aside><h2 id="step-4-submit-the-training-job" class="relative group"><span class="heading-text">Step 4: Submit the Training Job</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-4-submit-the-training-job" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>This command uses the <code>gcloud</code> CLI to submit a <strong>Vertex AI Custom Training Job</strong> based on the specifications in <code>vertex_job.yaml</code>.</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre">export REGION=&quot;europe-west4&quot; # change to any region you want
export AIMSUSERNAME=&quot;&lt;YOUR_AIMS_USERNAME&gt;&quot;
export JOB_NAME=&quot;${AIMSUSERNAME}-gemma-finetune-$(date +%Y%m%d%H%M%S)&quot;

gcloud ai custom-jobs create \
    --region=${REGION} \
    --display-name=${JOB_NAME} \
    --config=vertex_job.yaml \
    --project=${PROJECT_ID}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>You should see an output confirming that the job was successfully created with a job ID.</p><figure id="Om4oiNowta" class="fig-figure"><img id="mkdMuoZpf4" style="margin-left:auto;margin-right:auto" src="/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png" alt="Custom Vertex AI training job submitted" data-canonical-url="./images/gcloud-submit-vertexai-custom-training-job.png" class=""/><figcaption class="group"><p>Screenshot: Terminal output showing successfully Vertex AI training job creation with job ID</p></figcaption></figure><h2 id="step-5-monitor-the-job" class="relative group"><span class="heading-text">Step 5: Monitor the Job</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-5-monitor-the-job" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Check the job status from the CLI:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre">gcloud ai custom-jobs list \
    --region=${REGION} \
    --project=${PROJECT_ID}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p>Stream the logs in real time:</p><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre"># Ger the Job ID using the Display Name
JOB_ID=$(gcloud ai custom-jobs list \     
    --region=${REGION} \
    --filter=&quot;displayName=${JOB_NAME}&quot; \
    --format=&quot;value(name.scope(customJobs))&quot;)

# Stream the logs using the ID
gcloud ai custom-jobs stream-logs ${JOB_ID} --region=${REGION}</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><p><strong>You can also monitor the job from the GCP Console.</strong></p><ol start="1"><li><p>Go to <strong>Vertex AI</strong> page on your GCP Console</p></li><li><p>Navigate to the <strong>Custom Jobs</strong> tab. Ensure the region you used when submitting the job is selected.</p></li><li><p>Click on the job you want to monitor</p></li><li><p>Click on <strong>View logs</strong> to view the logs for the training job.</p></li></ol><figure id="iNg1MhEAdI" class="fig-figure"><img id="R0mAesl5xJ" style="margin-left:auto;margin-right:auto" src="/gcp-tutorial-aims/build/gcp-console-vertexai-5ca951883f0f01cde8902e03d829ded3.png" alt="GCP Console showing the custom jobs list with job status" data-canonical-url="./images/gcp-console-vertexai-custom-jobs-list-finished-status.png" class=""/><figcaption class="group"><p>Screenshot: GCP Console showing the custom jobs list with job status</p></figcaption></figure><figure id="N6C8Wnss0L" class="fig-figure"><img id="Aq1JEsGyD5" style="margin-left:auto;margin-right:auto" src="/gcp-tutorial-aims/build/gcp-console-vertex-a-aacd6bfda0b96bed91d36d1ef186e9e3.png" alt="GCP Console showing details for a custom training job" data-canonical-url="./images/gcp-console-vertex-ai-custom-training-job.png" class=""/><figcaption class="group"><p>Screenshot: GCP Console showing details for a custom training job with the “View logs” link</p></figcaption></figure><figure id="Pq6ZA3jpwE" class="fig-figure"><img id="GkI7XP1UMC" style="margin-left:auto;margin-right:auto" src="/gcp-tutorial-aims/build/gcp-console-vertexai-168acccbf7499b838f80b0be1cc8dbff.png" alt="GCP Console showing the custom training job logs streaming in real time" data-canonical-url="./images/gcp-console-vertexai-training-job-logs.png" class=""/><figcaption class="group"><p>Screenshot: GCP Console showing the custom training job logs streaming in real time</p></figcaption></figure><p>As with the VM-based run, you can also monitor training metrics in real time from your WandB dashboard at <a target="_blank" rel="noreferrer" href="http://wandb.ai" class="link whitespace-nowrap"><span class="link-text whitespace-normal">wandb.ai</span><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" class="link-icon"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 6H5.25A2.25 2.25 0 0 0 3 8.25v10.5A2.25 2.25 0 0 0 5.25 21h10.5A2.25 2.25 0 0 0 18 18.75V10.5m-10.5 6L21 3m0 0h-5.25M21 3v5.25"></path></svg></a>. You will see. <code>train/loss</code>, <code>eval/loss</code>, <code>train/grad_norm</code>, <code>train/learning_rate</code>, etc., updating every 10 steps.</p><h2 id="step-6-verify-the-outputs-in-gcs" class="relative group"><span class="heading-text">Step 6: Verify the Outputs in GCS</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-6-verify-the-outputs-in-gcs" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Once the job status changes to <code>FINISHED</code>, we can verify that the outputs were synced to your GCS bucket successfully using the GCP Console.</p><figure id="cOki6W5OOm" class="fig-figure"><img id="NIG3EOQKUO" style="margin-left:auto;margin-right:auto" src="/gcp-tutorial-aims/build/gcp-console-vertexai-7e7c5cb0ddf73521d299ff1f12414633.png" alt="GCS Bucket in GCP Console showing output folder" data-canonical-url="./images/gcp-console-vertexai-custom-training-job-output-gcs-bucket.png" class=""/><figcaption class="group"><p>Screenshot: GCS Bucket in GCP Console showing synced output folder</p></figcaption></figure><h2 id="step-7-resource-cleanup" class="relative group"><span class="heading-text">Step 7: Resource Cleanup</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#step-7-resource-cleanup" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>Vertex AI Custom Training Jobs terminate automatically when the job completes, so there is no VM delete. The only resource to clean up is the GCS bucket if you no longer need the outputs:</p><aside class="myst-admonition myst-admonition-danger my-5 shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-gray-50/10 dark:bg-stone-800 overflow-hidden myst-admonition-default rounded border-l-4 border-red-600"><div class="myst-admonition-header m-0 font-medium py-1 flex min-w-0 text-lg text-red-600 bg-red-50 dark:bg-slate-900"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" data-slot="icon" width="2rem" height="2rem" class="myst-admonition-header-icon inline-block pl-2 mr-2 self-center flex-none text-red-600"><path fill-rule="evenodd" d="M2.25 12c0-5.385 4.365-9.75 9.75-9.75s9.75 4.365 9.75 9.75-4.365 9.75-9.75 9.75S2.25 17.385 2.25 12ZM12 8.25a.75.75 0 0 1 .75.75v3.75a.75.75 0 0 1-1.5 0V9a.75.75 0 0 1 .75-.75Zm0 8.25a.75.75 0 1 0 0-1.5.75.75 0 0 0 0 1.5Z" clip-rule="evenodd"></path></svg><div class="myst-admonition-header-text text-neutral-900 dark:text-white grow self-center overflow-hidden break-words">Danger</div></div><div class="myst-admonition-body px-4 py-1"><p>Only delete the bucket if you no longer need the checkpoints. If you want to keep your trained model, skip this step or download the outputs locally first.</p></div></aside><div class="relative myst-code group not-prose my-5 text-sm shadow hover:shadow-md dark:shadow-2xl dark:shadow-neutral-900 bg-stone-200/10"><pre class="block overflow-auto p-3 myst-code-body hljs" style="background-color:unset"><code class="language-bash" style="white-space:pre">gcloud storage rm --recursive gs://&lt;YOUR_GCS_BUCKET_NAME&gt;</code></pre><button title="Copy to Clipboard" class="inline-flex items-center opacity-0 group-hover:opacity-100 hover:opacity-100 focus:opacity-100 active:opacity-100 cursor-pointer ml-2 transition-color duration-200 ease-in-out text-blue-400 hover:text-blue-500 absolute right-1 myst-code-copy-icon top-1" aria-pressed="false" aria-label="Copy code to clipboard"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="24" height="24"><path stroke-linecap="round" stroke-linejoin="round" d="M15.75 17.25v3.375c0 .621-.504 1.125-1.125 1.125h-9.75a1.125 1.125 0 0 1-1.125-1.125V7.875c0-.621.504-1.125 1.125-1.125H6.75a9.06 9.06 0 0 1 1.5.124m7.5 10.376h3.375c.621 0 1.125-.504 1.125-1.125V11.25c0-4.46-3.243-8.161-7.5-8.876a9.06 9.06 0 0 0-1.5-.124H9.375c-.621 0-1.125.504-1.125 1.125v3.5m7.5 10.375H9.375a1.125 1.125 0 0 1-1.125-1.125v-9.25m12 6.625v-1.875a3.375 3.375 0 0 0-3.375-3.375h-1.5a1.125 1.125 0 0 1-1.125-1.125v-1.5a3.375 3.375 0 0 0-3.375-3.375H9.75"></path></svg></button></div><hr class="py-2 my-5 translate-y-2"/><h2 id="id-key-takeaways" class="relative group"><span class="heading-text">🔑 Key Takeaways</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-key-takeaways" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><ul><li><p>Vertex AI Custom Training Jobs eliminate all infrastructure management. You submit a job spec, Vertex AI provisions the hardware, runs the job, and terminates everything automatically when done.</p></li><li><p>You pay only for the duration of the job. There are no idle costs unlike a raw VM that keeps running until you manually delete it.</p></li><li><p>The training code itself does not change at all. The only difference from the VM-based approach is how you submit and monitor the job.</p></li><li><p>Using a pre-built container image with PyTorch already installed significantly speeds up job startup time by avoiding large dependency downloads.</p></li><li><p>Always sync outputs to GCS explicitly at the end of the job since HuggingFace Trainer saves checkpoints locally inside the ephemeral container.</p></li></ul><h2 id="id-whats-next" class="relative group"><span class="heading-text">🚀 What’s Next</span><a class="no-underline text-inherit hover:text-inherit inline-block w-0 px-0 translate-x-[10px] font-normal select-none transition-opacity opacity-0 focus:opacity-100 group-hover:opacity-70" href="#id-whats-next" title="Link to this Section" aria-label="Link to this Section">¶</a></h2><p>In the next hands-on session, we will run the same experiment interactively using <strong>Vertex AI Colab Enterprise</strong>, a managed notebook environment accessible directly from your browser with no SSH or infrastructure setup required.</p><div class="myst-backmatter-parts"></div><div class="myst-footer-links flex pt-10 mb-10 space-x-4"><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-prev" href="/gcp-tutorial-aims/part3-vertex-ai"><div class="flex h-full align-middle"><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:-translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M10.5 19.5 3 12m0 0 7.5-7.5M3 12h18"></path></svg><div class="flex-grow text-right"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Part 3 - Vertex AI</div>Introduction</div></div></a><a class="myst-footer-link flex-1 block p-4 font-normal text-gray-600 no-underline border border-gray-200 rounded shadow-sm group hover:border-blue-600 dark:hover:border-blue-400 hover:text-blue-600 dark:hover:text-blue-400 dark:text-gray-100 dark:border-gray-500 hover:shadow-lg dark:shadow-neutral-700 myst-footer-link-next" href="/gcp-tutorial-aims/part3-vertex-ai/hands-on-vertex-ai-notebook-colab-enterprise"><div class="flex h-full align-middle"><div class="flex-grow"><div class="myst-footer-link-group text-xs text-gray-500 dark:text-gray-400">Part 3 - Vertex AI</div>Hands-On 02: Vertex AI Notebooks (Colab Enterprise)</div><svg xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" aria-hidden="true" data-slot="icon" width="1.5rem" height="1.5rem" class="myst-footer-link-icon self-center transition-transform group-hover:translate-x-1 shrink-0"><path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3"></path></svg></div></a></div></article></main><script>((a,l)=>{if(!window.history.state||!window.history.state.key){let u=Math.random().toString(32).slice(2);window.history.replaceState({key:u},"")}try{let d=JSON.parse(sessionStorage.getItem(a)||"{}")[l||window.history.state.key];typeof d=="number"&&window.scrollTo(0,d)}catch(u){console.error(u),sessionStorage.removeItem(a)}})("positions", null)</script><link rel="modulepreload" href="/gcp-tutorial-aims/build/entry.client-PCJPW7TK.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-AQ2CODAG.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-JJXTQVMA.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-OZE3FFNP.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-G62B6HZR.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-C4DFGG5C.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-J7TUH54J.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-FZ2S7OYD.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-JEM6JXYA.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-34XIY2DH.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-KQM5FBHR.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-OCWQY3HK.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-7HNKBP4B.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-CUKUDK3R.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-3EBOCCHJ.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-O4VQNZ62.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-4OEDG4JQ.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-GUCIBHGO.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/root-PMP5BIHC.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/_shared/chunk-IX5KPAHP.js"/><link rel="modulepreload" href="/gcp-tutorial-aims/build/routes/$-5ZLZ2O3Y.js"/><script>window.__remixContext = {"url":"/part3-vertex-ai/hands-on-vertex-ai-custom-training-job","state":{"loaderData":{"root":{"config":{"version":3,"myst":"1.8.1","title":"AIMS GCP ML Tutorial","options":{"favicon":"/gcp-tutorial-aims/build/favicon-f7b3896533bc18e7649da390cf29f0f4.ico","logo_text":"AIMS GCP ML Tutorial","folders":true},"nav":[],"actions":[],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"AIMS GCP Tutorial","description":"A no-fluff guide to using GCP for ML experiments and research","authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"id":"7eddb7b1-9986-44d1-8417-fe2b2bb4b498","toc":[{"file":"index.md"},{"children":[{"file":"part1-gcp-foundations/index.md"},{"file":"part1-gcp-foundations/01-understanding-gcp.md"},{"file":"part1-gcp-foundations/02-gcp-console.md"},{"file":"part1-gcp-foundations/03-the-gcloud-cli.md"},{"file":"part1-gcp-foundations/04-hands-on-gcp-console.md"},{"file":"part1-gcp-foundations/05-hands-on-gcloud-cli.md"}],"title":"Part 1 - GCP Foundations"},{"children":[{"file":"part2-running-experiments-on-gcp-vms/index.md"},{"file":"part2-running-experiments-on-gcp-vms/01-hands-on-running-ai-experiments-on-gcp-vms.md"}],"title":"Part 2 - Running Experiments On GCP VMs"},{"children":[{"file":"part3-vertex-ai/index.md"},{"file":"part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md"},{"file":"part3-vertex-ai/02-hands-on-vertex-ai-notebook-colab-enterprise.md"}],"title":"Part 3 - Vertex AI"},{"children":[{"file":"part4-cost-management/index.md"},{"file":"part4-cost-management/01-hands-on-cost-management.md"}],"title":"Part 4 - Cost Management"},{"children":[{"file":"appendix/01-gpu-maths.md"},{"file":"append"}],"title":"Appendix"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Part 1 - GCP Foundations"},{"slug":"part1-gcp-foundations.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.understanding-gcp","title":"GCP Core Concepts","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.gcp-console","title":"The GCP Console","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-overview-8e8b446f04fb688222b85418bedb2a82.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.the-gcloud-cli","title":"The Google Cloud CLI (gcloud)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.hands-on-gcp-console","title":"Hands-On 01: Create a VM via GCP Console","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/hands-on1-gcp-consol-12a3399ac5b13c81fe8057ccb402f849.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.hands-on-gcloud-cli","title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/hands-on2-gcloud-vm--ec1294417a0584c93f49d7ef18dde2b3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 2 - Running Experiments On GCP VMs"},{"slug":"part2-running-experiments-on-gcp-vms.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part2-running-experiments-on-gcp-vms.hands-on-running-ai-experiments-on-gcp-vms","title":"Hands-On 01: Fine-tuning a Small Language Model (Gemma 3 1B) on a GCP VM","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/create_new_project_w-2eb6f68628f9ac15adde26ff153e7212.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 3 - Vertex AI"},{"slug":"part3-vertex-ai.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part3-vertex-ai.hands-on-vertex-ai-custom-training-job","title":"Hands-On 01: Vertex AI Custom Training Jobs","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part3-vertex-ai.hands-on-vertex-ai-notebook-colab-enterprise","title":"Hands-On 02: Vertex AI Notebooks (Colab Enterprise)","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-colab-en-9c467a94a29b3dbd7b55cbe9bc42e12a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 4 - Cost Management"},{"slug":"part4-cost-management.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part4-cost-management.hands-on-cost-management","title":"Hands-On: Setting Up Billing Alerts and Budgets","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-create-b-10c558aa82b612d79d67b2c5cc90d849.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendix"},{"slug":"appendix.gpu-maths","title":"Appendix A: GPU Maths - Choosing the Right GPU for Your Experiment","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"CONTENT_CDN_PORT":"3100","MODE":"static","BASE_URL":"/gcp-tutorial-aims"},"routes/$":{"config":{"version":3,"myst":"1.8.1","title":"AIMS GCP ML Tutorial","options":{"favicon":"/gcp-tutorial-aims/build/favicon-f7b3896533bc18e7649da390cf29f0f4.ico","logo_text":"AIMS GCP ML Tutorial","folders":true},"nav":[],"actions":[],"projects":[{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"AIMS GCP Tutorial","description":"A no-fluff guide to using GCP for ML experiments and research","authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"id":"7eddb7b1-9986-44d1-8417-fe2b2bb4b498","toc":[{"file":"index.md"},{"children":[{"file":"part1-gcp-foundations/index.md"},{"file":"part1-gcp-foundations/01-understanding-gcp.md"},{"file":"part1-gcp-foundations/02-gcp-console.md"},{"file":"part1-gcp-foundations/03-the-gcloud-cli.md"},{"file":"part1-gcp-foundations/04-hands-on-gcp-console.md"},{"file":"part1-gcp-foundations/05-hands-on-gcloud-cli.md"}],"title":"Part 1 - GCP Foundations"},{"children":[{"file":"part2-running-experiments-on-gcp-vms/index.md"},{"file":"part2-running-experiments-on-gcp-vms/01-hands-on-running-ai-experiments-on-gcp-vms.md"}],"title":"Part 2 - Running Experiments On GCP VMs"},{"children":[{"file":"part3-vertex-ai/index.md"},{"file":"part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md"},{"file":"part3-vertex-ai/02-hands-on-vertex-ai-notebook-colab-enterprise.md"}],"title":"Part 3 - Vertex AI"},{"children":[{"file":"part4-cost-management/index.md"},{"file":"part4-cost-management/01-hands-on-cost-management.md"}],"title":"Part 4 - Cost Management"},{"children":[{"file":"appendix/01-gpu-maths.md"},{"file":"append"}],"title":"Appendix"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Part 1 - GCP Foundations"},{"slug":"part1-gcp-foundations.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.understanding-gcp","title":"GCP Core Concepts","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.gcp-console","title":"The GCP Console","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-overview-8e8b446f04fb688222b85418bedb2a82.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.the-gcloud-cli","title":"The Google Cloud CLI (gcloud)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.hands-on-gcp-console","title":"Hands-On 01: Create a VM via GCP Console","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/hands-on1-gcp-consol-12a3399ac5b13c81fe8057ccb402f849.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.hands-on-gcloud-cli","title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/hands-on2-gcloud-vm--ec1294417a0584c93f49d7ef18dde2b3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 2 - Running Experiments On GCP VMs"},{"slug":"part2-running-experiments-on-gcp-vms.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part2-running-experiments-on-gcp-vms.hands-on-running-ai-experiments-on-gcp-vms","title":"Hands-On 01: Fine-tuning a Small Language Model (Gemma 3 1B) on a GCP VM","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/create_new_project_w-2eb6f68628f9ac15adde26ff153e7212.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 3 - Vertex AI"},{"slug":"part3-vertex-ai.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part3-vertex-ai.hands-on-vertex-ai-custom-training-job","title":"Hands-On 01: Vertex AI Custom Training Jobs","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part3-vertex-ai.hands-on-vertex-ai-notebook-colab-enterprise","title":"Hands-On 02: Vertex AI Notebooks (Colab Enterprise)","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-colab-en-9c467a94a29b3dbd7b55cbe9bc42e12a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 4 - Cost Management"},{"slug":"part4-cost-management.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part4-cost-management.hands-on-cost-management","title":"Hands-On: Setting Up Billing Alerts and Budgets","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-create-b-10c558aa82b612d79d67b2c5cc90d849.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendix"},{"slug":"appendix.gpu-maths","title":"Appendix A: GPU Maths - Choosing the Right GPU for Your Experiment","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}]},"page":{"version":3,"kind":"Article","sha256":"0da348794fdb163b272d707627bd6322b4f3354a4f96c66bd3eb96a8ab28533c","slug":"part3-vertex-ai.hands-on-vertex-ai-custom-training-job","location":"/part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md","dependencies":[],"frontmatter":{"title":"Hands-On 01: Vertex AI Custom Training Jobs","content_includes_title":false,"authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/blob/main/part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md","edit_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/edit/main/part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md","thumbnail":"/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png","exports":[{"format":"md","filename":"01-hands-on-vertex-ai-custom-training-job.md","url":"/gcp-tutorial-aims/build/01-hands-on-vertex-a-67ef92fb594d8da91fb4c89f3303405c.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Overview","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"spAu9DkeVG"}],"identifier":"overview","label":"Overview","html_id":"overview","implicit":true,"key":"TySxxNBCkF"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"In the previous hands-on session, we ran the Gemma 1B fine-tuning experiment on a raw GCP VM. We had to provision the VM, SSH in, set up the environment, and manually manage the entire process. In this session we will run the exact same experiment as a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"xBeRoyvRtG"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"Vertex AI Custom Training Job","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"dQKnAkyoCo"}],"key":"WvcWjcubvu"},{"type":"text","value":", where Vertex AI handles all the infrastructure for us. We submit a ","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"PGsHUpXPku"},{"type":"strong","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"children":[{"type":"text","value":"job spec","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"BZPJy9H5bC"}],"key":"Ia6Dt5PvCy"},{"type":"text","value":", Vertex AI provisions the hardware, runs the job, and terminates everything automatically when done.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Y70pOMCeoS"}],"key":"GUPQZRNHXn"},{"type":"heading","depth":2,"position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"children":[{"type":"text","value":"Learning Objectives","position":{"start":{"line":7,"column":1},"end":{"line":7,"column":1}},"key":"SCSpXMIAFB"}],"identifier":"learning-objectives","label":"Learning Objectives","html_id":"learning-objectives","implicit":true,"key":"KOpqrBgQ2g"},{"type":"paragraph","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"children":[{"type":"text","value":"By the end of this session, you will be able to:","position":{"start":{"line":9,"column":1},"end":{"line":9,"column":1}},"key":"RXZCsMCDHA"}],"key":"gizHsa3Ewf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":11,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Enable the Vertex AI API and set up the required permissions","position":{"start":{"line":11,"column":1},"end":{"line":11,"column":1}},"key":"FFsMqK4a67"}],"key":"ZOPdCSlO4K"}],"key":"mRFpvxogA5"},{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Write a Vertex AI Custom Training Job config file","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"lnm5G8cX1f"}],"key":"q4cdQEzDOy"}],"key":"bMnCqRMrkl"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Submit and monitor a training job using the ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"aLUs8cmyuP"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"g4SWyPF74W"},{"type":"text","value":" CLI","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"KDL5rcfr6v"}],"key":"Q8Hqyfvqzy"}],"key":"gcuZY0h1YJ"}],"key":"J5XwVoOoef"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"HthH4lcQ4j"}],"key":"Os3V25f7GW"},{"type":"paragraph","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"This hands-on uses the same fine-tuning experiment from the previous session. If you want to understand the experiment in detail, including the model, dataset, and training code, refer back to ","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"ZNSbiosImj"},{"type":"link","url":"/part2-running-experiments-on-gcp-vms/hands-on-running-ai-experiments-on-gcp-vms","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"children":[{"type":"text","value":"Hands-On: Fine-Tuning Gemma 1B on a GCP VM","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"Ym9X1sdvTI"}],"urlSource":"../part2-running-experiments-on-gcp-vms/01-hands-on-running-ai-experiments-on-gcp-vms.md","dataUrl":"/part2-running-experiments-on-gcp-vms.hands-on-running-ai-experiments-on-gcp-vms.json","internal":true,"protocol":"file","key":"xdHQzvgTki"},{"type":"text","value":".","position":{"start":{"line":16,"column":1},"end":{"line":16,"column":1}},"key":"m4r5rWDDoL"}],"key":"fmIMzqgqqj"}],"key":"ZmhEf9qBKp"},{"type":"heading","depth":2,"position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"children":[{"type":"text","value":"Prerequisites","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"X6yT5Y9kOJ"}],"identifier":"prerequisites","label":"Prerequisites","html_id":"prerequisites","implicit":true,"key":"N12BSGSEcr"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":21,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"paragraph","children":[{"type":"inlineCode","value":"gcloud","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"fo9iYdeKUj"},{"type":"text","value":" CLI installed and configured on your local machine","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"qfDuF0WmC2"}],"key":"KD8I41LkBJ"}],"key":"Rv6F9o9TrJ"},{"type":"listItem","spread":true,"position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A WandB account and API key","position":{"start":{"line":22,"column":1},"end":{"line":22,"column":1}},"key":"mNrIMvD3s7"}],"key":"vJxWcn4hZu"}],"key":"dEg5arCUdR"},{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"A HuggingFace account and API token with the Gemma 3 1B model license agreement accepted.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"iJygu3cXAI"}],"key":"IskoPbdbBT"}],"key":"lWp059bMOd"}],"key":"pGdUTzZsFp"},{"type":"thematicBreak","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"Z1gHgbQSFj"},{"type":"heading","depth":2,"position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"text","value":"Step 1: Enable the Vertex AI API","position":{"start":{"line":26,"column":1},"end":{"line":26,"column":1}},"key":"jErtHzRTGF"}],"identifier":"step-1-enable-the-vertex-ai-api","label":"Step 1: Enable the Vertex AI API","html_id":"step-1-enable-the-vertex-ai-api","implicit":true,"key":"M6wY2D72aV"},{"type":"paragraph","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"children":[{"type":"text","value":"Run this from your local machine to enable the Vertex AI API:","position":{"start":{"line":28,"column":1},"end":{"line":28,"column":1}},"key":"iaqHhtQJ2H"}],"key":"ZICz8xs6PW"},{"type":"code","lang":"bash","value":"export PROJECT_ID=$(gcloud config get-value project)\n\ngcloud services enable aiplatform.googleapis.com \\\n    --project=${PROJECT_ID}","key":"kf0Le1AJGX"},{"type":"paragraph","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"children":[{"type":"text","value":"Verify it has been enabled:","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"uEeTPXp5Rt"}],"key":"SFc5nq6Vkk"},{"type":"code","lang":"bash","value":"gcloud services list --enabled \\\n    --filter=\"name:aiplatform.googleapis.com\" \\\n    --project=${PROJECT_ID}","key":"T2MPC2IyRT"},{"type":"heading","depth":2,"position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"children":[{"type":"text","value":"Step 2: Grant the Required Permissions","position":{"start":{"line":45,"column":1},"end":{"line":45,"column":1}},"key":"l6tNdjB70o"}],"identifier":"step-2-grant-the-required-permissions","label":"Step 2: Grant the Required Permissions","html_id":"step-2-grant-the-required-permissions","implicit":true,"key":"AlkrHRlMKs"},{"type":"paragraph","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"children":[{"type":"text","value":"Vertex AI training jobs run under a service account. Grant it the permissions it needs to read and write to GCS.","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"oRK69EA5Kf"}],"key":"loOg7BAbEL"},{"type":"code","lang":"bash","value":"export SERVICE_ACCOUNT=$(gcloud iam service-accounts list \\\n    --filter=\"displayName:Compute Engine default service account\" \\\n    --format=\"value(email)\" \\\n    --project=${PROJECT_ID})\n\ngcloud projects add-iam-policy-binding ${PROJECT_ID} \\\n    --member=\"serviceAccount:${SERVICE_ACCOUNT}\" \\\n    --role=\"roles/storage.admin\"\n\ngcloud projects add-iam-policy-binding ${PROJECT_ID} \\\n    --member=\"serviceAccount:${SERVICE_ACCOUNT}\" \\\n    --role=\"roles/aiplatform.user\"","key":"l13SR08moH"},{"type":"heading","depth":2,"position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"children":[{"type":"text","value":"Step 3: Create the Job Config","position":{"start":{"line":64,"column":1},"end":{"line":64,"column":1}},"key":"jwZ754bSw3"}],"identifier":"step-3-create-the-job-config","label":"Step 3: Create the Job Config","html_id":"step-3-create-the-job-config","implicit":true,"key":"QgnUA6q8sK"},{"type":"paragraph","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"children":[{"type":"text","value":"Vertex AI Custom Training Jobs are defined by a YAML config file that specifies the machine type, container image, and the command to run. Create a file called ","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"THrXc0MFnz"},{"type":"inlineCode","value":"vertex_job.yaml","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"O70Co7cGh9"},{"type":"text","value":" in your project folder.","position":{"start":{"line":66,"column":1},"end":{"line":66,"column":1}},"key":"ouggJRg1v6"}],"key":"tkBIi837si"},{"type":"paragraph","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"children":[{"type":"text","value":"Paste the following code, replacing the placeholder values for the environment variables (","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"D0buTAdMhi"},{"type":"inlineCode","value":"YOUR_HF_TOKEN","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"RugqYvQKqP"},{"type":"text","value":", ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"ekSDvBXSfs"},{"type":"inlineCode","value":"YOUR_WANDB_API_KEY","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"c4ajoBRyuh"},{"type":"text","value":", ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"flGpvcBUvV"},{"type":"inlineCode","value":"YOUR_WANDB_PROJECT","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"UdNEDA4yEz"},{"type":"text","value":", ","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"PrbJMPWmdJ"},{"type":"inlineCode","value":"YOUR_GCS_BUCKET_NAME","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"H1diAPW0a7"},{"type":"text","value":") with the actual values.","position":{"start":{"line":68,"column":1},"end":{"line":68,"column":1}},"key":"fn20PutWBJ"}],"key":"SLW1949hb6"},{"type":"code","lang":"yaml","value":"workerPoolSpecs:\n  - machineSpec:\n      machineType: g2-standard-4\n      acceleratorType: NVIDIA_L4\n      acceleratorCount: 1\n    replicaCount: 1\n    containerSpec:\n      imageUri: us-docker.pkg.dev/deeplearning-platform-release/gcr.io/pytorch-gpu.2-0.py310\n      command:\n        - bash\n        - -c\n      args:\n        - |\n          curl -LsSf https://astral.sh/uv/install.sh | sh \u0026\u0026\n          source $HOME/.local/bin/env \u0026\u0026\n          git clone https://github.com/rexsimiloluwah/finetuning-gemma-1b-aims-gcp-tutorial.git \u0026\u0026\n          cd finetuning-gemma-1b-aims-gcp-tutorial \u0026\u0026\n          uv sync \u0026\u0026\n          uv run python -m scripts.run_train data.source=gcs data.max_train_samples=10000 training.num_epochs=2 training.batch_size=8 experiment_id=exp_lora_r8_vertex\n          gsutil -m cp -r outputs/ gs://$BUCKET_NAME/runs/exp_lora_r8_vertex\n      env:\n        - name: HF_TOKEN\n          value: \u003cYOUR_HF_TOKEN\u003e\n        - name: WANDB_API_KEY\n          value: \u003cYOUR_WANDB_API_KEY\u003e\n        - name: WANDB_PROJECT\n          value: \u003cYOUR_WANDB_PROJECT\u003e\n        - name: BUCKET_NAME\n          value: \u003cYOUR_GCS_BUCKET_NAME\u003e","key":"So88jo0Vj3"},{"type":"paragraph","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"children":[{"type":"text","value":"This configuration does the following:","position":{"start":{"line":102,"column":1},"end":{"line":102,"column":1}},"key":"VUc0My27SO"}],"key":"wGWtL6mvSH"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":104,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Automatically spins up a Google Cloud VM equipped with an ","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"g7NCmAsNvR"},{"type":"strong","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"children":[{"type":"text","value":"NVIDIA L4 GPU","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"maMkOGxmtG"}],"key":"IQNQQu3esW"},{"type":"text","value":" and the necessary CUDA drivers.","position":{"start":{"line":104,"column":1},"end":{"line":104,"column":1}},"key":"xeeUnS2pza"}],"key":"x6esTPt2E6"}],"key":"PmSG7oigZN"},{"type":"listItem","spread":true,"position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Automates environment setup: clones the training code, installs the ","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"FhSuPioGkv"},{"type":"inlineCode","value":"uv","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"Rbhlodzd1s"},{"type":"text","value":" package manager, and installs all Python dependencies.","position":{"start":{"line":105,"column":1},"end":{"line":105,"column":1}},"key":"doYbmAgluR"}],"key":"vvuVUz20H1"}],"key":"SslzTwydfu"},{"type":"listItem","spread":true,"position":{"start":{"line":106,"column":1},"end":{"line":107,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Runs the Gemma 1B fine-tuning script and automatically persists the resulting model weights and logs to your GCS bucket.","position":{"start":{"line":106,"column":1},"end":{"line":106,"column":1}},"key":"kX8zBKv5Kt"}],"key":"IwQSq2o5K2"}],"key":"R82rYjxi5v"}],"key":"wFes7jf2UP"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Why this container image?","position":{"start":{"line":108,"column":1},"end":{"line":108,"column":1}},"key":"yrq8YSzHuI"}],"key":"Vzs4RokGeI"},{"type":"paragraph","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"children":[{"type":"text","value":"The ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"NOVQNJBLKY"},{"type":"inlineCode","value":"pytorch-gpu.2-0.py310","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"kpDAmDiaqc"},{"type":"text","value":" image comes with PyTorch, CUDA, and common ML libraries pre-installed. This means ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"Y7fzdPKfpg"},{"type":"inlineCode","value":"uv sync","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"qJO5WFqpbW"},{"type":"text","value":" only needs to install your smaller dependencies like ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"X38YUEZhEl"},{"type":"inlineCode","value":"transformers","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"O5CL64jHvM"},{"type":"text","value":", ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"mS8DP6IKrm"},{"type":"inlineCode","value":"peft","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"BmRWwjfTaA"},{"type":"text","value":", and ","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"cDjRQ7aHBg"},{"type":"inlineCode","value":"wandb","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"Gb2amFoL7z"},{"type":"text","value":", rather than downloading PyTorch (873MB) and CUDA libraries from scratch on every run.","position":{"start":{"line":110,"column":1},"end":{"line":110,"column":1}},"key":"TZExyAwO3j"}],"key":"cE94MYtS2a"}],"key":"bzHSOBGB4u"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Why ","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"wEy06WaELS"},{"type":"inlineCode","value":"gsutil cp","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"vnA2xUOXrZ"},{"type":"text","value":" command at the end?","position":{"start":{"line":113,"column":1},"end":{"line":113,"column":1}},"key":"lcVlIJGyFb"}],"key":"Osc7698ysD"},{"type":"paragraph","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"children":[{"type":"text","value":"HuggingFace Trainer saves checkpoints locally inside the container, which is ephemeral and lost when the job finishes. The ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"XT0XLZK0ow"},{"type":"inlineCode","value":"gsutil cp","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"HH3v03LIZA"},{"type":"text","value":" command at the end explicitly syncs the local ","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"B6A6JBztgi"},{"type":"inlineCode","value":"outputs/","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"xu4NEIed34"},{"type":"text","value":" directory to GCS after training completes, ensuring your checkpoints persist. This is the standard pattern for persisting outputs from Vertex AI training jobs when using HuggingFace Trainer.","position":{"start":{"line":115,"column":1},"end":{"line":115,"column":1}},"key":"j9WhgIw4lG"}],"key":"mhNtgyGWn1"}],"key":"fyvFZOOzq9"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"idVxRbddlt"}],"key":"dTNdIK7oiX"},{"type":"paragraph","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"children":[{"type":"text","value":"Do not commit the ","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"dNVNfPUS3G"},{"type":"inlineCode","value":"vertex_job.yaml","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"ehrelqTO49"},{"type":"text","value":" file to GitHub with your API keys in it. Add it to .gitignore to keep your credentials safe.","position":{"start":{"line":119,"column":1},"end":{"line":119,"column":1}},"key":"SalylVGCXT"}],"key":"zaLJouBkmc"}],"key":"knFN54h2wh"},{"type":"heading","depth":2,"position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"children":[{"type":"text","value":"Step 4: Submit the Training Job","position":{"start":{"line":122,"column":1},"end":{"line":122,"column":1}},"key":"PJ6Y4LObCq"}],"identifier":"step-4-submit-the-training-job","label":"Step 4: Submit the Training Job","html_id":"step-4-submit-the-training-job","implicit":true,"key":"V7F4L2y6B5"},{"type":"paragraph","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"This command uses the ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"q118ceXCut"},{"type":"inlineCode","value":"gcloud","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"GW2atvFcSN"},{"type":"text","value":" CLI to submit a ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"z5TEXbEOp6"},{"type":"strong","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"children":[{"type":"text","value":"Vertex AI Custom Training Job","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"PvQ1TMFZGl"}],"key":"BlHntHemOd"},{"type":"text","value":" based on the specifications in ","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"WhBs7KWV1y"},{"type":"inlineCode","value":"vertex_job.yaml","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"K1a1lqRaJn"},{"type":"text","value":".","position":{"start":{"line":124,"column":1},"end":{"line":124,"column":1}},"key":"JjPt2G94Lw"}],"key":"Wx31LBjpFZ"},{"type":"code","lang":"bash","value":"export REGION=\"europe-west4\" # change to any region you want\nexport AIMSUSERNAME=\"\u003cYOUR_AIMS_USERNAME\u003e\"\nexport JOB_NAME=\"${AIMSUSERNAME}-gemma-finetune-$(date +%Y%m%d%H%M%S)\"\n\ngcloud ai custom-jobs create \\\n    --region=${REGION} \\\n    --display-name=${JOB_NAME} \\\n    --config=vertex_job.yaml \\\n    --project=${PROJECT_ID}","key":"x4y3azdxa2"},{"type":"paragraph","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"children":[{"type":"text","value":"You should see an output confirming that the job was successfully created with a job ID.","position":{"start":{"line":138,"column":1},"end":{"line":138,"column":1}},"key":"vU3Va8wVVw"}],"key":"o3i5nSTeYV"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png","alt":"Custom Vertex AI training job submitted","align":"center","key":"mkdMuoZpf4","urlSource":"./images/gcloud-submit-vertexai-custom-training-job.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"children":[{"type":"text","value":"Screenshot: Terminal output showing successfully Vertex AI training job creation with job ID","position":{"start":{"line":144,"column":1},"end":{"line":144,"column":1}},"key":"AQN2VAFdOM"}],"key":"uHyo8Y0ip0"}],"key":"tlaZ0oAhrj"}],"enumerator":"1","key":"Om4oiNowta"},{"type":"heading","depth":2,"position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"children":[{"type":"text","value":"Step 5: Monitor the Job","position":{"start":{"line":147,"column":1},"end":{"line":147,"column":1}},"key":"rr5Ca5DlOZ"}],"identifier":"step-5-monitor-the-job","label":"Step 5: Monitor the Job","html_id":"step-5-monitor-the-job","implicit":true,"key":"TMTklEGkze"},{"type":"paragraph","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"children":[{"type":"text","value":"Check the job status from the CLI:","position":{"start":{"line":149,"column":1},"end":{"line":149,"column":1}},"key":"wwNAoAPVpX"}],"key":"tLBxncEeSY"},{"type":"code","lang":"bash","value":"gcloud ai custom-jobs list \\\n    --region=${REGION} \\\n    --project=${PROJECT_ID}","key":"ynJQoVPC2d"},{"type":"paragraph","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"children":[{"type":"text","value":"Stream the logs in real time:","position":{"start":{"line":157,"column":1},"end":{"line":157,"column":1}},"key":"eOrMiJCnCX"}],"key":"svjHXFc7HS"},{"type":"code","lang":"bash","value":"# Ger the Job ID using the Display Name\nJOB_ID=$(gcloud ai custom-jobs list \\     \n    --region=${REGION} \\\n    --filter=\"displayName=${JOB_NAME}\" \\\n    --format=\"value(name.scope(customJobs))\")\n\n# Stream the logs using the ID\ngcloud ai custom-jobs stream-logs ${JOB_ID} --region=${REGION}","key":"MOSkpIUkuS"},{"type":"paragraph","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"strong","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"children":[{"type":"text","value":"You can also monitor the job from the GCP Console.","position":{"start":{"line":170,"column":1},"end":{"line":170,"column":1}},"key":"jw2OPi1LAH"}],"key":"s3RNLSx4OS"}],"key":"MtCwOOYGsA"},{"type":"list","ordered":true,"start":1,"spread":false,"position":{"start":{"line":172,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Go to ","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"xQAY04QiRs"},{"type":"strong","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"children":[{"type":"text","value":"Vertex AI","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"NFk3U2t6je"}],"key":"JDeTAwVC16"},{"type":"text","value":" page on your GCP Console","position":{"start":{"line":172,"column":1},"end":{"line":172,"column":1}},"key":"yWnno1UqQV"}],"key":"cFco2Z96Cm"}],"key":"UZTSaD0ONj"},{"type":"listItem","spread":true,"position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Navigate to the ","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"SX3eKzIbum"},{"type":"strong","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"children":[{"type":"text","value":"Custom Jobs","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"mxILKTTHfO"}],"key":"Ix8eWhraSy"},{"type":"text","value":" tab. Ensure the region you used when submitting the job is selected.","position":{"start":{"line":173,"column":1},"end":{"line":173,"column":1}},"key":"FOGtv5Nuby"}],"key":"ePyM3ITMYK"}],"key":"UxLo0lGHus"},{"type":"listItem","spread":true,"position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click on the job you want to monitor","position":{"start":{"line":174,"column":1},"end":{"line":174,"column":1}},"key":"cbxlsZ1UV3"}],"key":"MH5TGAtFEp"}],"key":"mHTfe6AuPU"},{"type":"listItem","spread":true,"position":{"start":{"line":175,"column":1},"end":{"line":176,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Click on ","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"kbry409Bkx"},{"type":"strong","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"children":[{"type":"text","value":"View logs","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"DBD7TsE7WN"}],"key":"xdXIWdJ5kb"},{"type":"text","value":" to view the logs for the training job.","position":{"start":{"line":175,"column":1},"end":{"line":175,"column":1}},"key":"rDnkgv3M2Q"}],"key":"GCZ9WDiGZn"}],"key":"leH04V7UVr"}],"key":"YU7MhokiKq"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/gcp-console-vertexai-5ca951883f0f01cde8902e03d829ded3.png","alt":"GCP Console showing the custom jobs list with job status","align":"center","key":"R0mAesl5xJ","urlSource":"./images/gcp-console-vertexai-custom-jobs-list-finished-status.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"children":[{"type":"text","value":"Screenshot: GCP Console showing the custom jobs list with job status","position":{"start":{"line":181,"column":1},"end":{"line":181,"column":1}},"key":"n6AqFR43Rj"}],"key":"kERYDVOvwz"}],"key":"Mtl0HOSxCz"}],"enumerator":"2","key":"iNg1MhEAdI"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/gcp-console-vertex-a-aacd6bfda0b96bed91d36d1ef186e9e3.png","alt":"GCP Console showing details for a custom training job","align":"center","key":"Aq1JEsGyD5","urlSource":"./images/gcp-console-vertex-ai-custom-training-job.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"children":[{"type":"text","value":"Screenshot: GCP Console showing details for a custom training job with the “View logs” link","position":{"start":{"line":188,"column":1},"end":{"line":188,"column":1}},"key":"DXLalR8fZl"}],"key":"A6DbLYPuGx"}],"key":"IWIDJVA306"}],"enumerator":"3","key":"N6C8Wnss0L"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/gcp-console-vertexai-168acccbf7499b838f80b0be1cc8dbff.png","alt":"GCP Console showing the custom training job logs streaming in real time","align":"center","key":"GkI7XP1UMC","urlSource":"./images/gcp-console-vertexai-training-job-logs.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"children":[{"type":"text","value":"Screenshot: GCP Console showing the custom training job logs streaming in real time","position":{"start":{"line":195,"column":1},"end":{"line":195,"column":1}},"key":"Cm7Jzlzc3Q"}],"key":"PFim8bBmkx"}],"key":"NN2OKUecmp"}],"enumerator":"4","key":"Pq6ZA3jpwE"},{"type":"paragraph","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"As with the VM-based run, you can also monitor training metrics in real time from your WandB dashboard at ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"Bf4rJ77Dwf"},{"type":"link","url":"http://wandb.ai","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"children":[{"type":"text","value":"wandb.ai","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"OgmOSGf3Xc"}],"urlSource":"http://wandb.ai","key":"iJLddo9Tzh"},{"type":"text","value":". You will see. ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"xqxWTnmJy8"},{"type":"inlineCode","value":"train/loss","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"f8tZuRPJrf"},{"type":"text","value":", ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"b4V1yuBG2S"},{"type":"inlineCode","value":"eval/loss","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"LgIC5g1IwI"},{"type":"text","value":", ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"mEsOAzYooZ"},{"type":"inlineCode","value":"train/grad_norm","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"bdQfDStC9o"},{"type":"text","value":", ","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"Ij2B2bu7RO"},{"type":"inlineCode","value":"train/learning_rate","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"SfMBXTY0mo"},{"type":"text","value":", etc., updating every 10 steps.","position":{"start":{"line":198,"column":1},"end":{"line":198,"column":1}},"key":"CXoV0IWTYE"}],"key":"UQIF3M2WEi"},{"type":"heading","depth":2,"position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"children":[{"type":"text","value":"Step 6: Verify the Outputs in GCS","position":{"start":{"line":200,"column":1},"end":{"line":200,"column":1}},"key":"K2I45EFFYr"}],"identifier":"step-6-verify-the-outputs-in-gcs","label":"Step 6: Verify the Outputs in GCS","html_id":"step-6-verify-the-outputs-in-gcs","implicit":true,"key":"fOAVVO7zVJ"},{"type":"paragraph","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"children":[{"type":"text","value":"Once the job status changes to ","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"SdEdLmbEuZ"},{"type":"inlineCode","value":"FINISHED","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"N2cofem28P"},{"type":"text","value":", we can verify that the outputs were synced to your GCS bucket successfully using the GCP Console.","position":{"start":{"line":202,"column":1},"end":{"line":202,"column":1}},"key":"lAvG23YN72"}],"key":"RKh2bm4Rox"},{"type":"container","kind":"figure","children":[{"type":"image","url":"/gcp-tutorial-aims/build/gcp-console-vertexai-7e7c5cb0ddf73521d299ff1f12414633.png","alt":"GCS Bucket in GCP Console showing output folder","align":"center","key":"NIG3EOQKUO","urlSource":"./images/gcp-console-vertexai-custom-training-job-output-gcs-bucket.png"},{"type":"caption","children":[{"type":"paragraph","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"children":[{"type":"text","value":"Screenshot: GCS Bucket in GCP Console showing synced output folder","position":{"start":{"line":208,"column":1},"end":{"line":208,"column":1}},"key":"KOlHUaOe1M"}],"key":"ozYJiCtwkp"}],"key":"vvmcjaA2Gb"}],"enumerator":"5","key":"cOki6W5OOm"},{"type":"heading","depth":2,"position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"children":[{"type":"text","value":"Step 7: Resource Cleanup","position":{"start":{"line":211,"column":1},"end":{"line":211,"column":1}},"key":"lGXa84B8kN"}],"identifier":"step-7-resource-cleanup","label":"Step 7: Resource Cleanup","html_id":"step-7-resource-cleanup","implicit":true,"key":"gKyvRmfPVR"},{"type":"paragraph","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"children":[{"type":"text","value":"Vertex AI Custom Training Jobs terminate automatically when the job completes, so there is no VM delete. The only resource to clean up is the GCS bucket if you no longer need the outputs:","position":{"start":{"line":213,"column":1},"end":{"line":213,"column":1}},"key":"j931y7DIwB"}],"key":"EiVqpenwY4"},{"type":"admonition","kind":"danger","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Danger","key":"uXuDpNMDwP"}],"key":"FBAXb96xw5"},{"type":"paragraph","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"children":[{"type":"text","value":"Only delete the bucket if you no longer need the checkpoints. If you want to keep your trained model, skip this step or download the outputs locally first.","position":{"start":{"line":216,"column":1},"end":{"line":216,"column":1}},"key":"cFMaDOIcOE"}],"key":"eBRaO4jgRl"}],"key":"BXQMRx1i5l"},{"type":"code","lang":"bash","value":"gcloud storage rm --recursive gs://\u003cYOUR_GCS_BUCKET_NAME\u003e","key":"s7VnHKQMSr"},{"type":"thematicBreak","position":{"start":{"line":223,"column":1},"end":{"line":223,"column":1}},"key":"yAgy4M2VmT"},{"type":"heading","depth":2,"position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"children":[{"type":"text","value":"🔑 Key Takeaways","position":{"start":{"line":225,"column":1},"end":{"line":225,"column":1}},"key":"GBxG0fVEoF"}],"identifier":"id-key-takeaways","label":"🔑 Key Takeaways","html_id":"id-key-takeaways","implicit":true,"key":"fXT0om0cKt"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":226,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Vertex AI Custom Training Jobs eliminate all infrastructure management. You submit a job spec, Vertex AI provisions the hardware, runs the job, and terminates everything automatically when done.","position":{"start":{"line":226,"column":1},"end":{"line":226,"column":1}},"key":"nftiIPVyIZ"}],"key":"y7P4Lc9q3k"}],"key":"qiYRRJjEby"},{"type":"listItem","spread":true,"position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You pay only for the duration of the job. There are no idle costs unlike a raw VM that keeps running until you manually delete it.","position":{"start":{"line":227,"column":1},"end":{"line":227,"column":1}},"key":"uBvSpBb9Do"}],"key":"QjItf0XaIo"}],"key":"v6vuZoj07y"},{"type":"listItem","spread":true,"position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"The training code itself does not change at all. The only difference from the VM-based approach is how you submit and monitor the job.","position":{"start":{"line":228,"column":1},"end":{"line":228,"column":1}},"key":"jxJjXtrQCI"}],"key":"QjTvwQDV91"}],"key":"ITqwWyGtki"},{"type":"listItem","spread":true,"position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Using a pre-built container image with PyTorch already installed significantly speeds up job startup time by avoiding large dependency downloads.","position":{"start":{"line":229,"column":1},"end":{"line":229,"column":1}},"key":"gCG08zBEPI"}],"key":"tvRqSLvCs1"}],"key":"SwonaWyVUy"},{"type":"listItem","spread":true,"position":{"start":{"line":230,"column":1},"end":{"line":231,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Always sync outputs to GCS explicitly at the end of the job since HuggingFace Trainer saves checkpoints locally inside the ephemeral container.","position":{"start":{"line":230,"column":1},"end":{"line":230,"column":1}},"key":"dupE9gznL2"}],"key":"Tcty4PxoYx"}],"key":"iZl2a8x78r"}],"key":"khdEgPQFtj"},{"type":"heading","depth":2,"position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"children":[{"type":"text","value":"🚀 What’s Next","position":{"start":{"line":232,"column":1},"end":{"line":232,"column":1}},"key":"pkK7mnvmTk"}],"identifier":"id-whats-next","label":"🚀 What’s Next","html_id":"id-whats-next","implicit":true,"key":"xrS5m3FfBi"},{"type":"paragraph","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"In the next hands-on session, we will run the same experiment interactively using ","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"lJyR0Uz1e7"},{"type":"strong","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"children":[{"type":"text","value":"Vertex AI Colab Enterprise","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"vjPSodMtHb"}],"key":"kqN6cxjW1I"},{"type":"text","value":", a managed notebook environment accessible directly from your browser with no SSH or infrastructure setup required.","position":{"start":{"line":234,"column":1},"end":{"line":234,"column":1}},"key":"WTSuSWOjxb"}],"key":"BzSVqALKLL"}],"key":"OIif1SsG3y"}],"key":"QwwI5W9MFY"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Introduction","url":"/part3-vertex-ai","group":"Part 3 - Vertex AI"},"next":{"title":"Hands-On 02: Vertex AI Notebooks (Colab Enterprise)","url":"/part3-vertex-ai/hands-on-vertex-ai-notebook-colab-enterprise","group":"Part 3 - Vertex AI"}}},"domain":"http://localhost:3000"},"project":{"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"title":"AIMS GCP Tutorial","description":"A no-fluff guide to using GCP for ML experiments and research","authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"id":"7eddb7b1-9986-44d1-8417-fe2b2bb4b498","toc":[{"file":"index.md"},{"children":[{"file":"part1-gcp-foundations/index.md"},{"file":"part1-gcp-foundations/01-understanding-gcp.md"},{"file":"part1-gcp-foundations/02-gcp-console.md"},{"file":"part1-gcp-foundations/03-the-gcloud-cli.md"},{"file":"part1-gcp-foundations/04-hands-on-gcp-console.md"},{"file":"part1-gcp-foundations/05-hands-on-gcloud-cli.md"}],"title":"Part 1 - GCP Foundations"},{"children":[{"file":"part2-running-experiments-on-gcp-vms/index.md"},{"file":"part2-running-experiments-on-gcp-vms/01-hands-on-running-ai-experiments-on-gcp-vms.md"}],"title":"Part 2 - Running Experiments On GCP VMs"},{"children":[{"file":"part3-vertex-ai/index.md"},{"file":"part3-vertex-ai/01-hands-on-vertex-ai-custom-training-job.md"},{"file":"part3-vertex-ai/02-hands-on-vertex-ai-notebook-colab-enterprise.md"}],"title":"Part 3 - Vertex AI"},{"children":[{"file":"part4-cost-management/index.md"},{"file":"part4-cost-management/01-hands-on-cost-management.md"}],"title":"Part 4 - Cost Management"},{"children":[{"file":"appendix/01-gpu-maths.md"},{"file":"append"}],"title":"Appendix"}],"exports":[],"bibliography":[],"index":"index","pages":[{"level":1,"title":"Part 1 - GCP Foundations"},{"slug":"part1-gcp-foundations.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.understanding-gcp","title":"GCP Core Concepts","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.gcp-console","title":"The GCP Console","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-overview-8e8b446f04fb688222b85418bedb2a82.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.the-gcloud-cli","title":"The Google Cloud CLI (gcloud)","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.hands-on-gcp-console","title":"Hands-On 01: Create a VM via GCP Console","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/hands-on1-gcp-consol-12a3399ac5b13c81fe8057ccb402f849.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part1-gcp-foundations.hands-on-gcloud-cli","title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/hands-on2-gcloud-vm--ec1294417a0584c93f49d7ef18dde2b3.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 2 - Running Experiments On GCP VMs"},{"slug":"part2-running-experiments-on-gcp-vms.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part2-running-experiments-on-gcp-vms.hands-on-running-ai-experiments-on-gcp-vms","title":"Hands-On 01: Fine-tuning a Small Language Model (Gemma 3 1B) on a GCP VM","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/create_new_project_w-2eb6f68628f9ac15adde26ff153e7212.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 3 - Vertex AI"},{"slug":"part3-vertex-ai.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part3-vertex-ai.hands-on-vertex-ai-custom-training-job","title":"Hands-On 01: Vertex AI Custom Training Jobs","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcloud-submit-vertex-fa224a3096b38995888e8f1bd1200cdb.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part3-vertex-ai.hands-on-vertex-ai-notebook-colab-enterprise","title":"Hands-On 02: Vertex AI Notebooks (Colab Enterprise)","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-colab-en-9c467a94a29b3dbd7b55cbe9bc42e12a.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Part 4 - Cost Management"},{"slug":"part4-cost-management.index","title":"Introduction","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"slug":"part4-cost-management.hands-on-cost-management","title":"Hands-On: Setting Up Billing Alerts and Budgets","description":"","date":"","thumbnail":"/gcp-tutorial-aims/build/gcp-console-create-b-10c558aa82b612d79d67b2c5cc90d849.png","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2},{"level":1,"title":"Appendix"},{"slug":"appendix.gpu-maths","title":"Appendix A: GPU Maths - Choosing the Right GPU for Your Experiment","description":"","date":"","thumbnail":"","thumbnailOptimized":"","banner":"","bannerOptimized":"","tags":[],"level":2}]}}},"actionData":null,"errors":null},"future":{"unstable_dev":false,"unstable_postcss":false,"unstable_tailwind":false,"v2_errorBoundary":true,"v2_headers":true,"v2_meta":true,"v2_normalizeFormMethod":true,"v2_routeConvention":true}};</script><script type="module" async="">import "/gcp-tutorial-aims/build/manifest-54BD5942.js";
import * as route0 from "/gcp-tutorial-aims/build/root-PMP5BIHC.js";
import * as route1 from "/gcp-tutorial-aims/build/routes/$-5ZLZ2O3Y.js";
window.__remixRouteModules = {"root":route0,"routes/$":route1};

import("/gcp-tutorial-aims/build/entry.client-PCJPW7TK.js");</script></body></html>