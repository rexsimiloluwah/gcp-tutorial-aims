{"version":3,"kind":"Article","sha256":"f847b5b9268f00d785c37d00d4e0546b7d8bd59e2f5d86b28f14fc852da1cc28","slug":"part2-running-experiments-on-gcp-vms.index","location":"/part2-running-experiments-on-gcp-vms/index.md","dependencies":[],"frontmatter":{"title":"Introduction","content_includes_title":false,"authors":[{"id":"AIMS TtT Team","name":"AIMS TtT Team"}],"license":{"content":{"id":"CC-BY-4.0","url":"https://creativecommons.org/licenses/by/4.0/","name":"Creative Commons Attribution 4.0 International","free":true,"CC":true}},"github":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial","keywords":["GCP","AI","GPU","Machine Learning","Research","Experiments","MLOps"],"numbering":{"title":{"offset":1}},"source_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/blob/main/part2-running-experiments-on-gcp-vms/index.md","edit_url":"https://github.com/rexsimiloluwa/aims-ai-gcp-tutorial/edit/main/part2-running-experiments-on-gcp-vms/index.md","exports":[{"format":"md","filename":"index.md","url":"/build/index-2f7370c5837845fe4f578e1abfa62729.md"}]},"mdast":{"type":"root","children":[{"type":"block","children":[{"type":"heading","depth":2,"position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"children":[{"type":"text","value":"Running AI Experiments on GCP VMs","position":{"start":{"line":3,"column":1},"end":{"line":3,"column":1}},"key":"Ry8JYW8fe8"}],"identifier":"running-ai-experiments-on-gcp-vms","label":"Running AI Experiments on GCP VMs","html_id":"running-ai-experiments-on-gcp-vms","implicit":true,"key":"vVlrU2k7Aw"},{"type":"paragraph","position":{"start":{"line":5,"column":1},"end":{"line":6,"column":1}},"children":[{"type":"text","value":"When a machine learning experiment outgrows your laptop, because the model is too large, training takes too long, or you need a GPU, the natural next step is to move it to the cloud.\nGCP virtual machines (VMs) give you on-demand access to powerful hardware, including modern GPUs like the NVIDIA L4, without the cost of owning physical hardware.","position":{"start":{"line":5,"column":1},"end":{"line":5,"column":1}},"key":"Ph0TpjSCXN"}],"key":"robAje36jX"},{"type":"paragraph","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"children":[{"type":"text","value":"Running experiments on a remote VM is conceptually simple: it is just a Linux machine you can SSH into and run Python code on. But there are a few things worth understanding before you get started.","position":{"start":{"line":8,"column":1},"end":{"line":8,"column":1}},"key":"NX3fGpX8mI"}],"key":"az7hXhd5Fq"},{"type":"heading","depth":3,"position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"children":[{"type":"text","value":"Reproducible Environments","position":{"start":{"line":10,"column":1},"end":{"line":10,"column":1}},"key":"AxInuk8D4R"}],"identifier":"reproducible-environments","label":"Reproducible Environments","html_id":"reproducible-environments","implicit":true,"key":"EDxOUgqOUO"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":12,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Code that works locally often fails on a VM due to different Python versions or package versions.","position":{"start":{"line":12,"column":1},"end":{"line":12,"column":1}},"key":"oUX4Bbqds2"}],"key":"x8DJK9mKm4"}],"key":"VjpXTXyj5x"},{"type":"listItem","spread":true,"position":{"start":{"line":13,"column":1},"end":{"line":14,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Hence it is important to use package managers like ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"bb3l4aDgKH"},{"type":"inlineCode","value":"uv","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"CEYKM4jFcE"},{"type":"text","value":" or ","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"I8HFxFSDOX"},{"type":"inlineCode","value":"poetry","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"yoeG6QrI8l"},{"type":"text","value":" to automate the installation, configuration, and management of software dependencies, ensuring consistency and reproducibility.","position":{"start":{"line":13,"column":1},"end":{"line":13,"column":1}},"key":"Lga3s1AY6k"}],"key":"JpqCggwhb8"}],"key":"tXHAEjy5q1"}],"key":"oKWL9y8h36"},{"type":"heading","depth":3,"position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"children":[{"type":"text","value":"Persistent Storage","position":{"start":{"line":15,"column":1},"end":{"line":15,"column":1}},"key":"Ye7VrW8gR0"}],"identifier":"persistent-storage","label":"Persistent Storage","html_id":"persistent-storage","implicit":true,"key":"FGIw1sm9s5"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":17,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"VM disks are ephemeral. When you delete the VM, everything else is deleted.","position":{"start":{"line":17,"column":1},"end":{"line":17,"column":1}},"key":"r4vKOO6jfB"}],"key":"iVaMl4JfQg"}],"key":"yW8UJIB0vT"},{"type":"listItem","spread":true,"position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"It is important to always write outputs, checkpoints, and logs to a persistent object storage like Google Cloud Storage (GCS) during or after training so they persist independently of the VM.","position":{"start":{"line":18,"column":1},"end":{"line":18,"column":1}},"key":"GO6HMyGORk"}],"key":"obzdmVJTuv"}],"key":"aiD5fdV2iK"},{"type":"listItem","spread":true,"position":{"start":{"line":19,"column":1},"end":{"line":20,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Think of the VM as temporary compute and GCS as permanent storage.","position":{"start":{"line":19,"column":1},"end":{"line":19,"column":1}},"key":"MBdBXOstjU"}],"key":"EaLnYQbeev"}],"key":"vA4lu43tDv"}],"key":"QEA5EpCFG0"},{"type":"heading","depth":3,"position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"children":[{"type":"text","value":"Long-Running Jobs","position":{"start":{"line":21,"column":1},"end":{"line":21,"column":1}},"key":"rQg3DXVDN7"}],"identifier":"long-running-jobs","label":"Long-Running Jobs","html_id":"long-running-jobs","implicit":true,"key":"PYCfMmqZp4"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":23,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Training machine learning models can take anywhere from minutes, for small models like XGBoost, to hours or even days for models like transformers or large language models.","position":{"start":{"line":23,"column":1},"end":{"line":23,"column":1}},"key":"wOxbVJdrgX"}],"key":"Rh1TCimB3a"}],"key":"rWZaLaSRJu"},{"type":"listItem","spread":true,"position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Keeping an SSH connection open for the entire duration is fragile. A dropped connection can kill the training process.","position":{"start":{"line":24,"column":1},"end":{"line":24,"column":1}},"key":"laSL1X93zs"}],"key":"z0Zd1kHmso"}],"key":"joMf2gflz8"},{"type":"listItem","spread":true,"position":{"start":{"line":25,"column":1},"end":{"line":26,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"You can use a tool like ","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"yv4Z5WZqNe"},{"type":"inlineCode","value":"tmux","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"PSRsyDc0GR"},{"type":"text","value":" to keep your process running on the VM even if your SSH session disconnects.","position":{"start":{"line":25,"column":1},"end":{"line":25,"column":1}},"key":"ogUMB3JOPm"}],"key":"BkRrabWETy"}],"key":"EyivydufyD"}],"key":"bialVvEkPc"},{"type":"heading","depth":3,"position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"children":[{"type":"text","value":"Experiment Monitoring and Logging","position":{"start":{"line":27,"column":1},"end":{"line":27,"column":1}},"key":"vxzfQn9dPh"}],"identifier":"experiment-monitoring-and-logging","label":"Experiment Monitoring and Logging","html_id":"experiment-monitoring-and-logging","implicit":true,"key":"VL6uh0p47S"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":29,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Experiment monitoring is the practice of logging and visualizing metrics as a model trains, giving you a live record of how your experiment is progressing.","position":{"start":{"line":29,"column":1},"end":{"line":29,"column":1}},"key":"tAluuFDzOU"}],"key":"JvLG2j9Xko"}],"key":"ii2u5ZvCys"},{"type":"listItem","spread":true,"position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"On a remote VM, you cannot just watch your terminal, so you need a tool that logs metrics to a dashboard you can access from anywhere.","position":{"start":{"line":30,"column":1},"end":{"line":30,"column":1}},"key":"Wb4ZfbbzTd"}],"key":"iA0tve87sO"}],"key":"jGgHWOQ2yA"},{"type":"listItem","spread":true,"position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tools like ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"VIJO2DRKkF"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Weights & Biases","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"KDMXztoLEI"}],"key":"PgNab0dIVs"},{"type":"text","value":", ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"iSizcvXyoQ"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"Tensorboard","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"uVQ6HvAlKz"}],"key":"hkGdd1Oh7T"},{"type":"text","value":", or ","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"Y7yXyeQo1L"},{"type":"strong","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"children":[{"type":"text","value":"MLFlow","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"NtYlPXeV0y"}],"key":"Z5ZTauh25Z"},{"type":"text","value":" automatically track metrics like loss, accuracy, and learning rate, hardware utilization, and maintain a history of every experiment you run.","position":{"start":{"line":31,"column":1},"end":{"line":31,"column":1}},"key":"b3LBqShfPc"}],"key":"J0JDe6A5in"}],"key":"Hype7LEOXu"},{"type":"listItem","spread":true,"position":{"start":{"line":32,"column":1},"end":{"line":33,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"This gives you a centralized record of all your experiments, making it easy to compare runs, spot regressions, and share results with others.","position":{"start":{"line":32,"column":1},"end":{"line":32,"column":1}},"key":"kiGZ0BTmfG"}],"key":"mhDOY6ViXH"}],"key":"FmanK1IjIV"}],"key":"YFI9hmfvcm"},{"type":"heading","depth":3,"position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"children":[{"type":"text","value":"Cost Management","position":{"start":{"line":34,"column":1},"end":{"line":34,"column":1}},"key":"tsMS6z9IcK"}],"identifier":"cost-management","label":"Cost Management","html_id":"cost-management","implicit":true,"key":"SbpjGD8GYf"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":36,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"VMs are billed by the second. An idle VM costs the same as a busy one.","position":{"start":{"line":36,"column":1},"end":{"line":36,"column":1}},"key":"x2CpcZsLLK"}],"key":"zFRIxhg5jS"}],"key":"MleSwpEvxr"},{"type":"listItem","spread":true,"position":{"start":{"line":37,"column":1},"end":{"line":38,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Always stop/delete your VM when an experiment is done.","position":{"start":{"line":37,"column":1},"end":{"line":37,"column":1}},"key":"posOj3Xdjh"}],"key":"uRa5ozliAH"}],"key":"zrNqPNHSeh"}],"key":"BwwACCQ5ys"},{"type":"admonition","kind":"note","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Note","key":"Rd7VLViozV"}],"key":"Iep1qCoJTV"},{"type":"paragraph","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"children":[{"type":"text","value":"GPU VMs are significantly more expensive than CPU VMs. An NVIDIA L4 instance costs roughly $0.70/hour. Always double-check that your VM has been deleted after a session by running gcloud compute instances list.","position":{"start":{"line":40,"column":1},"end":{"line":40,"column":1}},"key":"HehH8KJhi0"}],"key":"R6zGr0kIaD"}],"key":"RW1hwfDGno"},{"type":"admonition","kind":"warning","children":[{"type":"admonitionTitle","children":[{"type":"text","value":"Warning","key":"vfpNbBDPKC"}],"key":"h5Hgr7aiSy"},{"type":"paragraph","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"children":[{"type":"text","value":"Never store API keys or tokens directly in your code or commit them to GitHub. Use a .env file listed in .gitignore and load credentials at runtime.","position":{"start":{"line":44,"column":1},"end":{"line":44,"column":1}},"key":"AlGf90r4g9"}],"key":"sMvARnFK1L"}],"key":"rhsmhA7irD"},{"type":"thematicBreak","position":{"start":{"line":47,"column":1},"end":{"line":47,"column":1}},"key":"bJUJW0enwC"},{"type":"heading","depth":2,"position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"children":[{"type":"text","value":"ðŸš€ Whatâ€™s Next?","position":{"start":{"line":49,"column":1},"end":{"line":49,"column":1}},"key":"ux6xkGAn7o"}],"identifier":"id-whats-next","label":"ðŸš€ Whatâ€™s Next?","html_id":"id-whats-next","implicit":true,"key":"fFNKBgG5n6"},{"type":"paragraph","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"children":[{"type":"text","value":"In the hands-on session that follows, you will run a complete end-to-end ML experiment on a GCP VM with an NVIDIA L4 GPU. This will involve:","position":{"start":{"line":51,"column":1},"end":{"line":51,"column":1}},"key":"cWmWuBPmIf"}],"key":"cFE0g0zJWD"},{"type":"list","ordered":false,"spread":false,"position":{"start":{"line":53,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"listItem","spread":true,"position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Fine-tuning ","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"hK1xldmJWr"},{"type":"strong","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"children":[{"type":"text","value":"Gemma 3 1B","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"HKUO7IMNff"}],"key":"Og3VCEVbGo"},{"type":"text","value":" on the Dolly-15k instruction dataset using LoRA.","position":{"start":{"line":53,"column":1},"end":{"line":53,"column":1}},"key":"terE6Jmz8j"}],"key":"gvQz6dskPd"}],"key":"pa5y1K8f98"},{"type":"listItem","spread":true,"position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Tracking experiments in real time with ","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"bOkLdEMQK6"},{"type":"strong","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"children":[{"type":"text","value":"Weights & Biases","position":{"start":{"line":54,"column":1},"end":{"line":54,"column":1}},"key":"U1dZPk3FuZ"}],"key":"vvvjayqkkn"}],"key":"GwmZdDHpxF"}],"key":"T6SuUZUEwW"},{"type":"listItem","spread":true,"position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Persisting checkpoints and outputs to GCS","position":{"start":{"line":55,"column":1},"end":{"line":55,"column":1}},"key":"dclI5FOwmt"}],"key":"eO6FtLbUHK"}],"key":"zETPyvVUXx"},{"type":"listItem","spread":true,"position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"children":[{"type":"paragraph","children":[{"type":"text","value":"Running evaluation and inference on the trained model","position":{"start":{"line":56,"column":1},"end":{"line":56,"column":1}},"key":"ZT8azyq2EL"}],"key":"iNxIatRs15"}],"key":"tsBprfaRJC"}],"key":"GuM201vHWD"}],"key":"rJwWHGlfFI"}],"key":"ugtLKAhmar"},"references":{"cite":{"order":[],"data":{}}},"footer":{"navigation":{"prev":{"title":"Hands-On 02: Automation with the Google Cloud CLI (gcloud)","url":"/part1-gcp-foundations/hands-on-gcloud-cli","group":"Part 1 - GCP Foundations"},"next":{"title":"Hands-On 01: Fine-tuning a Small Language Model (Gemma 3 1B) on a GCP VM","url":"/part2-running-experiments-on-gcp-vms/hands-on-running-ai-experiments-on-gcp-vms","group":"Part 2 - Running Experiments On GCP VMs"}}},"domain":"http://localhost:3000"}